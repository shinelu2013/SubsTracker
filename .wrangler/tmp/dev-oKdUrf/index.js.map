{
  "version": 3,
  "sources": ["../bundle-a1OIIg/checked-fetch.js", "../../../index.js", "../../../../../../.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../../../.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-a1OIIg/middleware-insertion-facade.js", "../../../../../../.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/common.ts", "../bundle-a1OIIg/middleware-loader.entry.ts"],
  "sourceRoot": "/home/runner/work/SubsTracker/SubsTracker/.wrangler/tmp/dev-oKdUrf",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "// \u8BA2\u9605\u7EED\u671F\u901A\u77E5\u7F51\u7AD9 - \u57FA\u4E8ECloudFlare Workers (\u5B8C\u5168\u4F18\u5316\u7248)\n\n// \u65F6\u533A\u5DE5\u5177\u51FD\u6570\nfunction formatBeijingTime(date = new Date(), format = 'full') {\n  if (format === 'date') {\n    return date.toLocaleDateString('zh-CN', {\n      timeZone: 'Asia/Shanghai',\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit'\n    });\n  } else if (format === 'datetime') {\n    return date.toLocaleString('zh-CN', {\n      timeZone: 'Asia/Shanghai',\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  } else {\n    // full format\n    return date.toLocaleString('zh-CN', {\n      timeZone: 'Asia/Shanghai'\n    });\n  }\n}\n\n// \u519C\u5386\u8F6C\u6362\u5DE5\u5177\u51FD\u6570\nconst lunarCalendar = {\n  // \u519C\u5386\u6570\u636E (1900-2100\u5E74)\n  lunarInfo: [\n    0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,\n    0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,\n    0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,\n    0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,\n    0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,\n    0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0,\n    0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,\n    0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6,\n    0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,\n    0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,\n    0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,\n    0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,\n    0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,\n    0x05aa0, 0x076a3, 0x096d0, 0x04bd7, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,\n    0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0\n  ],\n\n  // \u5929\u5E72\u5730\u652F\n  gan: ['\u7532', '\u4E59', '\u4E19', '\u4E01', '\u620A', '\u5DF1', '\u5E9A', '\u8F9B', '\u58EC', '\u7678'],\n  zhi: ['\u5B50', '\u4E11', '\u5BC5', '\u536F', '\u8FB0', '\u5DF3', '\u5348', '\u672A', '\u7533', '\u9149', '\u620C', '\u4EA5'],\n\n  // \u519C\u5386\u6708\u4EFD\n  months: ['\u6B63', '\u4E8C', '\u4E09', '\u56DB', '\u4E94', '\u516D', '\u4E03', '\u516B', '\u4E5D', '\u5341', '\u51AC', '\u814A'],\n\n  // \u519C\u5386\u65E5\u671F\n  days: ['\u521D\u4E00', '\u521D\u4E8C', '\u521D\u4E09', '\u521D\u56DB', '\u521D\u4E94', '\u521D\u516D', '\u521D\u4E03', '\u521D\u516B', '\u521D\u4E5D', '\u521D\u5341',\n         '\u5341\u4E00', '\u5341\u4E8C', '\u5341\u4E09', '\u5341\u56DB', '\u5341\u4E94', '\u5341\u516D', '\u5341\u4E03', '\u5341\u516B', '\u5341\u4E5D', '\u4E8C\u5341',\n         '\u5EFF\u4E00', '\u5EFF\u4E8C', '\u5EFF\u4E09', '\u5EFF\u56DB', '\u5EFF\u4E94', '\u5EFF\u516D', '\u5EFF\u4E03', '\u5EFF\u516B', '\u5EFF\u4E5D', '\u4E09\u5341'],\n\n  // \u83B7\u53D6\u519C\u5386\u5E74\u5929\u6570\n  lunarYearDays: function(year) {\n    let sum = 348;\n    for (let i = 0x8000; i > 0x8; i >>= 1) {\n      sum += (this.lunarInfo[year - 1900] & i) ? 1 : 0;\n    }\n    return sum + this.leapDays(year);\n  },\n\n  // \u83B7\u53D6\u95F0\u6708\u5929\u6570\n  leapDays: function(year) {\n    if (this.leapMonth(year)) {\n      return (this.lunarInfo[year - 1900] & 0x10000) ? 30 : 29;\n    }\n    return 0;\n  },\n\n  // \u83B7\u53D6\u95F0\u6708\u6708\u4EFD\n  leapMonth: function(year) {\n    return this.lunarInfo[year - 1900] & 0xf;\n  },\n\n  // \u83B7\u53D6\u519C\u5386\u6708\u5929\u6570\n  monthDays: function(year, month) {\n    return (this.lunarInfo[year - 1900] & (0x10000 >> month)) ? 30 : 29;\n  },\n\n  // \u516C\u5386\u8F6C\u519C\u5386\n  solar2lunar: function(year, month, day) {\n    if (year < 1900 || year > 2100) return null;\n\n    const baseDate = new Date(1900, 0, 31);\n    const objDate = new Date(year, month - 1, day);\n    let offset = Math.floor((objDate - baseDate) / 86400000);\n\n    let temp = 0;\n    let lunarYear = 1900;\n\n    for (lunarYear = 1900; lunarYear < 2101 && offset > 0; lunarYear++) {\n      temp = this.lunarYearDays(lunarYear);\n      offset -= temp;\n    }\n\n    if (offset < 0) {\n      offset += temp;\n      lunarYear--;\n    }\n\n    let lunarMonth = 1;\n    let leap = this.leapMonth(lunarYear);\n    let isLeap = false;\n\n    for (lunarMonth = 1; lunarMonth < 13 && offset > 0; lunarMonth++) {\n      if (leap > 0 && lunarMonth === (leap + 1) && !isLeap) {\n        --lunarMonth;\n        isLeap = true;\n        temp = this.leapDays(lunarYear);\n      } else {\n        temp = this.monthDays(lunarYear, lunarMonth);\n      }\n\n      if (isLeap && lunarMonth === (leap + 1)) isLeap = false;\n      offset -= temp;\n    }\n\n    if (offset === 0 && leap > 0 && lunarMonth === leap + 1) {\n      if (isLeap) {\n        isLeap = false;\n      } else {\n        isLeap = true;\n        --lunarMonth;\n      }\n    }\n\n    if (offset < 0) {\n      offset += temp;\n      --lunarMonth;\n    }\n\n    const lunarDay = offset + 1;\n\n    // \u751F\u6210\u519C\u5386\u5B57\u7B26\u4E32\n    const ganIndex = (lunarYear - 4) % 10;\n    const zhiIndex = (lunarYear - 4) % 12;\n    const yearStr = this.gan[ganIndex] + this.zhi[zhiIndex] + '\u5E74';\n    const monthStr = (isLeap ? '\u95F0' : '') + this.months[lunarMonth - 1] + '\u6708';\n    const dayStr = this.days[lunarDay - 1];\n\n    return {\n      year: lunarYear,\n      month: lunarMonth,\n      day: lunarDay,\n      isLeap: isLeap,\n      yearStr: yearStr,\n      monthStr: monthStr,\n      dayStr: dayStr,\n      fullStr: yearStr + monthStr + dayStr\n    };\n  }\n};\n\n// 1. \u65B0\u589E lunarBiz \u5DE5\u5177\u6A21\u5757\uFF0C\u652F\u6301\u519C\u5386\u52A0\u5468\u671F\u3001\u519C\u5386\u8F6C\u516C\u5386\u3001\u519C\u5386\u8DDD\u79BB\u5929\u6570\nconst lunarBiz = {\n  // \u519C\u5386\u52A0\u5468\u671F\uFF0C\u8FD4\u56DE\u65B0\u7684\u519C\u5386\u65E5\u671F\u5BF9\u8C61\n  addLunarPeriod(lunar, periodValue, periodUnit) {\n    let { year, month, day, isLeap } = lunar;\n    if (periodUnit === 'year') {\n      year += periodValue;\n      const leap = lunarCalendar.leapMonth(year);\n      if (isLeap && leap === month) {\n        isLeap = true;\n      } else {\n        isLeap = false;\n      }\n    } else if (periodUnit === 'month') {\n      let totalMonths = (year - 1900) * 12 + (month - 1) + periodValue;\n      year = Math.floor(totalMonths / 12) + 1900;\n      month = (totalMonths % 12) + 1;\n      const leap = lunarCalendar.leapMonth(year);\n      if (isLeap && leap === month) {\n        isLeap = true;\n      } else {\n        isLeap = false;\n      }\n    } else if (periodUnit === 'day') {\n      const solar = lunarBiz.lunar2solar(lunar);\n      const date = new Date(solar.year, solar.month - 1, solar.day + periodValue);\n      return lunarCalendar.solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate());\n    }\n    let maxDay = isLeap\n      ? lunarCalendar.leapDays(year)\n      : lunarCalendar.monthDays(year, month);\n    let targetDay = Math.min(day, maxDay);\n    while (targetDay > 0) {\n      let solar = lunarBiz.lunar2solar({ year, month, day: targetDay, isLeap });\n      if (solar) {\n        return { year, month, day: targetDay, isLeap };\n      }\n      targetDay--;\n    }\n    return { year, month, day, isLeap };\n  },\n  // \u519C\u5386\u8F6C\u516C\u5386\uFF08\u904D\u5386\u6CD5\uFF0C\u9002\u75281900-2100\u5E74\uFF09\n  lunar2solar(lunar) {\n    for (let y = lunar.year - 1; y <= lunar.year + 1; y++) {\n      for (let m = 1; m <= 12; m++) {\n        for (let d = 1; d <= 31; d++) {\n          const date = new Date(y, m - 1, d);\n          if (date.getFullYear() !== y || date.getMonth() + 1 !== m || date.getDate() !== d) continue;\n          const l = lunarCalendar.solar2lunar(y, m, d);\n          if (\n            l &&\n            l.year === lunar.year &&\n            l.month === lunar.month &&\n            l.day === lunar.day &&\n            l.isLeap === lunar.isLeap\n          ) {\n            return { year: y, month: m, day: d };\n          }\n        }\n      }\n    }\n    return null;\n  },\n  // \u8DDD\u79BB\u519C\u5386\u65E5\u671F\u8FD8\u6709\u591A\u5C11\u5929\n  daysToLunar(lunar) {\n    const solar = lunarBiz.lunar2solar(lunar);\n    const date = new Date(solar.year, solar.month - 1, solar.day);\n    const now = new Date();\n    return Math.ceil((date - now) / (1000 * 60 * 60 * 24));\n  }\n};\n\n// \u5B9A\u4E49HTML\u6A21\u677F\nconst loginPage = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</title>\n  <link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\n  <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\" rel=\"stylesheet\">\n  <style>\n    .login-container {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      min-height: 100vh;\n    }\n    .login-box {\n      backdrop-filter: blur(8px);\n      background-color: rgba(255, 255, 255, 0.9);\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n    }\n    .btn-primary {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      transition: all 0.3s;\n    }\n    .btn-primary:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\n    }\n    .input-field {\n      transition: all 0.3s;\n      border: 1px solid #e2e8f0;\n    }\n    .input-field:focus {\n      border-color: #667eea;\n      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.25);\n    }\n  </style>\n</head>\n<body class=\"login-container flex items-center justify-center\">\n  <div class=\"login-box p-8 rounded-xl w-full max-w-md\">\n    <div class=\"text-center mb-8\">\n      <h1 class=\"text-2xl font-bold text-gray-800\"><i class=\"fas fa-calendar-check mr-2\"></i>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</h1>\n      <p class=\"text-gray-600 mt-2\">\u767B\u5F55\u7BA1\u7406\u60A8\u7684\u8BA2\u9605\u63D0\u9192</p>\n    </div>\n    \n    <form id=\"loginForm\" class=\"space-y-6\">\n      <div>\n        <label for=\"username\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n          <i class=\"fas fa-user mr-2\"></i>\u7528\u6237\u540D\n        </label>\n        <input type=\"text\" id=\"username\" name=\"username\" required\n          class=\"input-field w-full px-4 py-3 rounded-lg text-gray-700 focus:outline-none\">\n      </div>\n      \n      <div>\n        <label for=\"password\" class=\"block text-sm font-medium text-gray-700 mb-1\">\n          <i class=\"fas fa-lock mr-2\"></i>\u5BC6\u7801\n        </label>\n        <input type=\"password\" id=\"password\" name=\"password\" required\n          class=\"input-field w-full px-4 py-3 rounded-lg text-gray-700 focus:outline-none\">\n      </div>\n      \n      <button type=\"submit\" \n        class=\"btn-primary w-full py-3 rounded-lg text-white font-medium focus:outline-none\">\n        <i class=\"fas fa-sign-in-alt mr-2\"></i>\u767B\u5F55\n      </button>\n      \n      <div id=\"errorMsg\" class=\"text-red-500 text-center\"></div>\n    </form>\n  </div>\n  \n  <script>\n    document.getElementById('loginForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const username = document.getElementById('username').value;\n      const password = document.getElementById('password').value;\n      \n      const button = e.target.querySelector('button');\n      const originalContent = button.innerHTML;\n      button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u767B\u5F55\u4E2D...';\n      button.disabled = true;\n      \n      try {\n        const response = await fetch('/api/login', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ username, password })\n        });\n        \n        const result = await response.json();\n        \n        if (result.success) {\n          window.location.href = '/admin';\n        } else {\n          document.getElementById('errorMsg').textContent = result.message || '\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF';\n          button.innerHTML = originalContent;\n          button.disabled = false;\n        }\n      } catch (error) {\n        document.getElementById('errorMsg').textContent = '\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5';\n        button.innerHTML = originalContent;\n        button.disabled = false;\n      }\n    });\n  </script>\n</body>\n</html>\n`;\n\nconst adminPage = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</title>\n  <link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\n  <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\" rel=\"stylesheet\">\n  <style>\n    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); transition: all 0.3s; }\n    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-danger { background: linear-gradient(135deg, #f87171 0%, #dc2626 100%); transition: all 0.3s; }\n    .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-success { background: linear-gradient(135deg, #34d399 0%, #059669 100%); transition: all 0.3s; }\n    .btn-success:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-warning { background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%); transition: all 0.3s; }\n    .btn-warning:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-info { background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%); transition: all 0.3s; }\n    .btn-info:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .table-container { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }\n    .modal-container { backdrop-filter: blur(8px); }\n    .readonly-input { background-color: #f8fafc; border-color: #e2e8f0; cursor: not-allowed; }\n    .error-message { font-size: 0.875rem; margin-top: 0.25rem; display: none; }\n    .error-message.show { display: block; }\n\n    /* \u901A\u7528\u60AC\u6D6E\u63D0\u793A\u4F18\u5316 */\n    .hover-container {\n      position: relative;\n      width: 100%;\n    }\n    .hover-text {\n      max-width: 100%;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      cursor: pointer;\n      transition: all 0.3s ease;\n      display: block;\n    }\n    .hover-text:hover { color: #3b82f6; }\n    .hover-tooltip {\n      position: fixed;\n      z-index: 9999;\n      background: #1f2937;\n      color: white;\n      padding: 10px 14px;\n      border-radius: 8px;\n      font-size: 0.875rem;\n      max-width: 320px;\n      word-wrap: break-word;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n      opacity: 0;\n      visibility: hidden;\n      transition: all 0.3s ease;\n      transform: translateY(-10px);\n      white-space: normal;\n      pointer-events: none;\n      line-height: 1.4;\n    }\n    .hover-tooltip.show {\n      opacity: 1;\n      visibility: visible;\n      transform: translateY(0);\n    }\n    .hover-tooltip::before {\n      content: '';\n      position: absolute;\n      top: -6px;\n      left: 20px;\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid #1f2937;\n    }\n    .hover-tooltip.tooltip-above::before {\n      top: auto;\n      bottom: -6px;\n      border-bottom: none;\n      border-top: 6px solid #1f2937;\n    }\n\n    /* \u5907\u6CE8\u663E\u793A\u4F18\u5316 */\n    .notes-container {\n      position: relative;\n      max-width: 200px;\n      width: 100%;\n    }\n    .notes-text {\n      max-width: 100%;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      cursor: pointer;\n      transition: all 0.3s ease;\n      display: block;\n    }\n    .notes-text:hover { color: #3b82f6; }\n    .notes-tooltip {\n      position: fixed;\n      z-index: 9999;\n      background: #1f2937;\n      color: white;\n      padding: 10px 14px;\n      border-radius: 8px;\n      font-size: 0.875rem;\n      max-width: 320px;\n      word-wrap: break-word;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n      opacity: 0;\n      visibility: hidden;\n      transition: all 0.3s ease;\n      transform: translateY(-10px);\n      white-space: normal;\n      pointer-events: none;\n      line-height: 1.4;\n    }\n    .notes-tooltip.show {\n      opacity: 1;\n      visibility: visible;\n      transform: translateY(0);\n    }\n    .notes-tooltip::before {\n      content: '';\n      position: absolute;\n      top: -6px;\n      left: 20px;\n      border-left: 6px solid transparent;\n      border-right: 6px solid transparent;\n      border-bottom: 6px solid #1f2937;\n    }\n    .notes-tooltip.tooltip-above::before {\n      top: auto;\n      bottom: -6px;\n      border-bottom: none;\n      border-top: 6px solid #1f2937;\n    }\n\n    /* \u519C\u5386\u663E\u793A\u6837\u5F0F */\n    .lunar-display {\n      font-size: 0.75rem;\n      color: #6366f1;\n      margin-top: 2px;\n      opacity: 0;\n      transition: opacity 0.3s ease;\n    }\n    .lunar-display.show {\n      opacity: 1;\n    }\n    .lunar-toggle {\n      display: inline-flex;\n      align-items: center;\n      margin-bottom: 8px;\n      font-size: 0.875rem;\n    }\n    .lunar-toggle input[type=\"checkbox\"] {\n      margin-right: 6px;\n    }\n\n    /* \u8868\u683C\u5E03\u5C40\u4F18\u5316 */\n    .table-container {\n      width: 100%;\n      overflow: visible;\n    }\n\n    .table-container table {\n      table-layout: fixed;\n      width: 100%;\n    }\n\n    /* \u9632\u6B62\u8868\u683C\u5185\u5BB9\u6EA2\u51FA */\n    .table-container td {\n      overflow: hidden;\n      word-wrap: break-word;\n    }\n\n    .truncate {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n\n    /* \u54CD\u5E94\u5F0F\u4F18\u5316 */\n    .responsive-table { table-layout: fixed; width: 100%; }\n    .td-content-wrapper { word-wrap: break-word; white-space: normal; text-align: left; width: 100%; }\n    .td-content-wrapper > * { text-align: left; } /* Align content left within the wrapper */\n\n    @media (max-width: 767px) {\n      .table-container { overflow-x: initial; } /* Override previous setting */\n      .responsive-table thead { display: none; }\n      .responsive-table tbody, .responsive-table tr, .responsive-table td { display: block; width: 100%; }\n      .responsive-table tr { margin-bottom: 1.5rem; border: 1px solid #ddd; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05); overflow: hidden; }\n      .responsive-table td { display: flex; justify-content: flex-start; align-items: center; padding: 0.75rem 1rem; border-bottom: 1px solid #eee; }\n      .responsive-table td:last-of-type { border-bottom: none; }\n      .responsive-table td:before { content: attr(data-label); font-weight: 600; text-align: left; padding-right: 1rem; color: #374151; white-space: nowrap; }\n      .action-buttons-wrapper { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: flex-end; }\n      \n      .notes-container, .hover-container {\n        max-width: 180px; /* Adjust for new layout */\n        text-align: right;\n      }\n      .td-content-wrapper .notes-text {\n        text-align: right;\n      }\n    }\n\n    @media (min-width: 768px) {\n      .table-container {\n        overflow: visible;\n      }\n      /* .td-content-wrapper is aligned left by default */\n    }\n\n    /* Toast \u6837\u5F0F */\n    .toast {\n      position: fixed; top: 20px; right: 20px; padding: 12px 20px; border-radius: 8px;\n      color: white; font-weight: 500; z-index: 1000; transform: translateX(400px);\n      transition: all 0.3s ease-in-out; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    }\n    .toast.show { transform: translateX(0); }\n    .toast.success { background-color: #10b981; }\n    .toast.error { background-color: #ef4444; }\n    .toast.info { background-color: #3b82f6; }\n    .toast.warning { background-color: #f59e0b; }\n  </style>\n</head>\n<body class=\"bg-gray-100 min-h-screen\">\n  <div id=\"toast-container\"></div>\n\n  <nav class=\"bg-white shadow-md\">\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n      <div class=\"flex justify-between h-16\">\n        <div class=\"flex items-center\">\n          <i class=\"fas fa-calendar-check text-indigo-600 text-2xl mr-2\"></i>\n          <span class=\"font-bold text-xl text-gray-800\">\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</span>\n        </div>\n        <div class=\"flex items-center space-x-4\">\n          <a href=\"/admin\" class=\"text-indigo-600 border-b-2 border-indigo-600 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-list mr-1\"></i>\u8BA2\u9605\u5217\u8868\n          </a>\n          <a href=\"/admin/config\" class=\"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-cog mr-1\"></i>\u7CFB\u7EDF\u914D\u7F6E\n          </a>\n          <a href=\"/api/logout\" class=\"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-sign-out-alt mr-1\"></i>\u9000\u51FA\u767B\u5F55\n          </a>\n        </div>\n      </div>\n    </div>\n  </nav>\n  \n  <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n    <div class=\"flex justify-between items-center mb-6\">\n      <h2 class=\"text-2xl font-bold text-gray-800\">\u8BA2\u9605\u5217\u8868</h2>\n      <div class=\"flex items-center space-x-4\">\n        <div class=\"flex items-center\">\n          <label for=\"typeFilter\" class=\"text-sm font-medium text-gray-700 mr-2\">\u7C7B\u578B\u7B5B\u9009:</label>\n          <select id=\"typeFilter\" class=\"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n            <option value=\"\">\u5168\u90E8</option>\n          </select>\n        </div>\n        <label class=\"lunar-toggle\">\n          <input type=\"checkbox\" id=\"listShowLunar\" class=\"form-checkbox h-4 w-4 text-indigo-600\">\n          <span class=\"text-gray-700\">\u663E\u793A\u519C\u5386</span>\n        </label>\n        <button id=\"addSubscriptionBtn\" class=\"btn-primary text-white px-4 py-2 rounded-md text-sm font-medium flex items-center\">\n          <i class=\"fas fa-plus mr-2\"></i>\u6DFB\u52A0\u65B0\u8BA2\u9605\n        </button>\n      </div>\n    </div>\n    \n    <div class=\"table-container bg-white rounded-lg overflow-hidden\">\n      <div class=\"overflow-x-auto\">\n        <table class=\"w-full divide-y divide-gray-200 responsive-table\">\n          <thead class=\"bg-gray-50\">\n            <tr>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 20%;\">\n                \u540D\u79F0\n              </th>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 12%;\">\n                \u7C7B\u578B\n              </th>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 18%;\">\n                \u5230\u671F\u65F6\u95F4 <i class=\"fas fa-sort-up ml-1 text-indigo-500\" title=\"\u6309\u5230\u671F\u65F6\u95F4\u5347\u5E8F\u6392\u5217\"></i>\n              </th>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 10%;\">\n                \u91D1\u989D\n              </th>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 12%;\">\n                \u63D0\u9192\u8BBE\u7F6E\n              </th>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 10%;\">\n                \u72B6\u6001\n              </th>\n              <th scope=\"col\" class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\" style=\"width: 18%;\">\n                \u64CD\u4F5C\n              </th>\n            </tr>\n          </thead>\n        <tbody id=\"subscriptionsBody\" class=\"bg-white divide-y divide-gray-200\">\n        </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n\n  <!-- \u6DFB\u52A0/\u7F16\u8F91\u8BA2\u9605\u7684\u6A21\u6001\u6846 -->\n  <div id=\"subscriptionModal\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 modal-container hidden flex items-center justify-center z-50\">\n    <div class=\"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto\">\n      <div class=\"bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg\">\n        <div class=\"flex items-center justify-between\">\n          <h3 id=\"modalTitle\" class=\"text-lg font-medium text-gray-900\">\u6DFB\u52A0\u65B0\u8BA2\u9605</h3>\n          <button id=\"closeModal\" class=\"text-gray-400 hover:text-gray-600\">\n            <i class=\"fas fa-times text-xl\"></i>\n          </button>\n        </div>\n      </div>\n      \n      <form id=\"subscriptionForm\" class=\"p-6 space-y-6\">\n        <input type=\"hidden\" id=\"subscriptionId\">\n        \n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label for=\"name\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u8BA2\u9605\u540D\u79F0 *</label>\n            <input type=\"text\" id=\"name\" required\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n          \n          <div>\n            <label for=\"customType\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u8BA2\u9605\u7C7B\u578B</label>\n            <input type=\"text\" id=\"customType\" placeholder=\"\u4F8B\u5982\uFF1A\u6D41\u5A92\u4F53\u3001\u4E91\u670D\u52A1\u3001\u8F6F\u4EF6\u7B49\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n        </div>\n        \n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label for=\"amount\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u8BA2\u9605\u91D1\u989D</label>\n            <div class=\"flex space-x-2\">\n              <div class=\"flex-1 relative\">\n                <input type=\"number\" id=\"amount\" step=\"0.01\" min=\"0\" placeholder=\"0.00\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n              </div>\n              <div class=\"w-32\">\n                <select id=\"currency\" class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n                  <option value=\"NTD\" selected>\u53F0\u5E63 (NTD)</option>\n                  <option value=\"USD\">\u7F8E\u5143 (USD)</option>\n                  <option value=\"JPY\">\u65E5\u5143 (JPY)</option>\n                  <option value=\"EUR\">\u6B50\u5143 (EUR)</option>\n                  <option value=\"CNY\">\u4EBA\u6C11\u5E63 (CNY)</option>\n                </select>\n              </div>\n            </div>\n            <p class=\"text-xs text-gray-500 mt-1\">\u8BA2\u9605\u8D39\u7528\uFF08\u53EF\u9009\uFF09</p>\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n          <div></div>\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"lunar-toggle\">\n            <input type=\"checkbox\" id=\"showLunar\" class=\"form-checkbox h-4 w-4 text-indigo-600\">\n            <span class=\"text-gray-700\">\u663E\u793A\u519C\u5386\u65E5\u671F</span>\n          </label>\n        </div>\n\t\t<!-- \u65B0\u589E\u4FEE\u6539\uFF0C\u5728\u8868\u5355\u6DFB\u52A0\"\u5468\u671F\u6309\u519C\u5386\"\u590D\u9009\u6846\uFF0C\u5EFA\u8BAE\u653E\u5728\"\u663E\u793A\u519C\u5386\u65E5\u671F\"\u4E0B\u65B9 -->\n\t\t<div class=\"mb-4\">\n\t\t  <label class=\"lunar-toggle\">\n\t\t\t<input type=\"checkbox\" id=\"useLunar\" class=\"form-checkbox h-4 w-4 text-indigo-600\">\n\t\t\t<span class=\"text-gray-700\">\u5468\u671F\u6309\u519C\u5386</span>\n\t\t  </label>\n\t\t</div>\n\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <div>\n            <label for=\"startDate\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u5F00\u59CB\u65E5\u671F</label>\n            <input type=\"date\" id=\"startDate\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n            <div id=\"startDateLunar\" class=\"lunar-display\"></div>\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n          \n          <div>\n            <label for=\"periodValue\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u5468\u671F\u6570\u503C *</label>\n            <input type=\"number\" id=\"periodValue\" min=\"1\" value=\"1\" required\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n          \n          <div>\n            <label for=\"periodUnit\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u5468\u671F\u5355\u4F4D *</label>\n            <select id=\"periodUnit\" required\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n              <option value=\"day\">\u5929</option>\n              <option value=\"month\" selected>\u6708</option>\n              <option value=\"year\">\u5E74</option>\n            </select>\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n        </div>\n        \n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label for=\"expiryDate\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u5230\u671F\u65E5\u671F *</label>\n            <input type=\"date\" id=\"expiryDate\" required\n              class=\"readonly-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none\">\n            <div id=\"expiryDateLunar\" class=\"lunar-display\"></div>\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n          \n          <div class=\"flex items-end\">\n            <button type=\"button\" id=\"calculateExpiryBtn\" \n              class=\"btn-primary text-white px-4 py-2 rounded-md text-sm font-medium h-10\">\n              <i class=\"fas fa-calculator mr-2\"></i>\u81EA\u52A8\u8BA1\u7B97\u5230\u671F\u65E5\u671F\n            </button>\n          </div>\n        </div>\n        \n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label for=\"reminderDays\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u63D0\u524D\u63D0\u9192\u5929\u6570</label>\n            <input type=\"number\" id=\"reminderDays\" min=\"0\" value=\"7\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\">\n            <p class=\"text-xs text-gray-500 mt-1\">0 = \u4EC5\u5230\u671F\u65E5\u5F53\u5929\u63D0\u9192\uFF0C1+ = \u63D0\u524DN\u5929\u5F00\u59CB\u63D0\u9192</p>\n            <div class=\"error-message text-red-500\"></div>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 mb-3\">\u9009\u9879\u8BBE\u7F6E</label>\n            <div class=\"space-y-2\">\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" id=\"isActive\" checked \n                  class=\"form-checkbox h-4 w-4 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u542F\u7528\u8BA2\u9605</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" id=\"autoRenew\" checked \n                  class=\"form-checkbox h-4 w-4 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u81EA\u52A8\u7EED\u8BA2</span>\n              </label>\n            </div>\n          </div>\n        </div>\n        \n        <div>\n          <label for=\"notes\" class=\"block text-sm font-medium text-gray-700 mb-1\">\u5907\u6CE8</label>\n          <textarea id=\"notes\" rows=\"3\" placeholder=\"\u53EF\u6DFB\u52A0\u76F8\u5173\u5907\u6CE8\u4FE1\u606F...\"\n            class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500\"></textarea>\n          <div class=\"error-message text-red-500\"></div>\n        </div>\n        \n        <div class=\"flex justify-end space-x-3 pt-4 border-t border-gray-200\">\n          <button type=\"button\" id=\"cancelBtn\" \n            class=\"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50\">\n            \u53D6\u6D88\n          </button>\n          <button type=\"submit\" \n            class=\"btn-primary text-white px-4 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-save mr-2\"></i>\u4FDD\u5B58\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n\n  <script>\n    // \u65F6\u533A\u5DE5\u5177\u51FD\u6570 - \u524D\u7AEF\u7248\u672C\n    function formatBeijingTime(date = new Date(), format = 'full') {\n      if (format === 'date') {\n        return date.toLocaleDateString('zh-CN', {\n          timeZone: 'Asia/Shanghai',\n          year: 'numeric',\n          month: '2-digit',\n          day: '2-digit'\n        });\n      } else if (format === 'datetime') {\n        return date.toLocaleString('zh-CN', {\n          timeZone: 'Asia/Shanghai',\n          year: 'numeric',\n          month: '2-digit',\n          day: '2-digit',\n          hour: '2-digit',\n          minute: '2-digit',\n          second: '2-digit'\n        });\n      } else {\n        // full format\n        return date.toLocaleString('zh-CN', {\n          timeZone: 'Asia/Shanghai'\n        });\n      }\n    }\n\n    // \u519C\u5386\u8F6C\u6362\u5DE5\u5177\u51FD\u6570 - \u524D\u7AEF\u7248\u672C\n    const lunarCalendar = {\n      // \u519C\u5386\u6570\u636E (1900-2100\u5E74)\n      lunarInfo: [\n        0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,\n        0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,\n        0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,\n        0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,\n        0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,\n        0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0,\n        0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,\n        0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6,\n        0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,\n        0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,\n        0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,\n        0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,\n        0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,\n        0x05aa0, 0x076a3, 0x096d0, 0x04bd7, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,\n        0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0\n      ],\n\n      // \u5929\u5E72\u5730\u652F\n      gan: ['\u7532', '\u4E59', '\u4E19', '\u4E01', '\u620A', '\u5DF1', '\u5E9A', '\u8F9B', '\u58EC', '\u7678'],\n      zhi: ['\u5B50', '\u4E11', '\u5BC5', '\u536F', '\u8FB0', '\u5DF3', '\u5348', '\u672A', '\u7533', '\u9149', '\u620C', '\u4EA5'],\n\n      // \u519C\u5386\u6708\u4EFD\n      months: ['\u6B63', '\u4E8C', '\u4E09', '\u56DB', '\u4E94', '\u516D', '\u4E03', '\u516B', '\u4E5D', '\u5341', '\u51AC', '\u814A'],\n\n      // \u519C\u5386\u65E5\u671F\n      days: ['\u521D\u4E00', '\u521D\u4E8C', '\u521D\u4E09', '\u521D\u56DB', '\u521D\u4E94', '\u521D\u516D', '\u521D\u4E03', '\u521D\u516B', '\u521D\u4E5D', '\u521D\u5341',\n             '\u5341\u4E00', '\u5341\u4E8C', '\u5341\u4E09', '\u5341\u56DB', '\u5341\u4E94', '\u5341\u516D', '\u5341\u4E03', '\u5341\u516B', '\u5341\u4E5D', '\u4E8C\u5341',\n             '\u5EFF\u4E00', '\u5EFF\u4E8C', '\u5EFF\u4E09', '\u5EFF\u56DB', '\u5EFF\u4E94', '\u5EFF\u516D', '\u5EFF\u4E03', '\u5EFF\u516B', '\u5EFF\u4E5D', '\u4E09\u5341'],\n\n      // \u83B7\u53D6\u519C\u5386\u5E74\u5929\u6570\n      lunarYearDays: function(year) {\n        let sum = 348;\n        for (let i = 0x8000; i > 0x8; i >>= 1) {\n          sum += (this.lunarInfo[year - 1900] & i) ? 1 : 0;\n        }\n        return sum + this.leapDays(year);\n      },\n\n      // \u83B7\u53D6\u95F0\u6708\u5929\u6570\n      leapDays: function(year) {\n        if (this.leapMonth(year)) {\n          return (this.lunarInfo[year - 1900] & 0x10000) ? 30 : 29;\n        }\n        return 0;\n      },\n\n      // \u83B7\u53D6\u95F0\u6708\u6708\u4EFD\n      leapMonth: function(year) {\n        return this.lunarInfo[year - 1900] & 0xf;\n      },\n\n      // \u83B7\u53D6\u519C\u5386\u6708\u5929\u6570\n      monthDays: function(year, month) {\n        return (this.lunarInfo[year - 1900] & (0x10000 >> month)) ? 30 : 29;\n      },\n\n      // \u516C\u5386\u8F6C\u519C\u5386\n      solar2lunar: function(year, month, day) {\n        if (year < 1900 || year > 2100) return null;\n\n        const baseDate = new Date(1900, 0, 31);\n        const objDate = new Date(year, month - 1, day);\n        let offset = Math.floor((objDate - baseDate) / 86400000);\n\n        let temp = 0;\n        let lunarYear = 1900;\n\n        for (lunarYear = 1900; lunarYear < 2101 && offset > 0; lunarYear++) {\n          temp = this.lunarYearDays(lunarYear);\n          offset -= temp;\n        }\n\n        if (offset < 0) {\n          offset += temp;\n          lunarYear--;\n        }\n\n        let lunarMonth = 1;\n        let leap = this.leapMonth(lunarYear);\n        let isLeap = false;\n\n        for (lunarMonth = 1; lunarMonth < 13 && offset > 0; lunarMonth++) {\n          if (leap > 0 && lunarMonth === (leap + 1) && !isLeap) {\n            --lunarMonth;\n            isLeap = true;\n            temp = this.leapDays(lunarYear);\n          } else {\n            temp = this.monthDays(lunarYear, lunarMonth);\n          }\n\n          if (isLeap && lunarMonth === (leap + 1)) isLeap = false;\n          offset -= temp;\n        }\n\n        if (offset === 0 && leap > 0 && lunarMonth === leap + 1) {\n          if (isLeap) {\n            isLeap = false;\n          } else {\n            isLeap = true;\n            --lunarMonth;\n          }\n        }\n\n        if (offset < 0) {\n          offset += temp;\n          --lunarMonth;\n        }\n\n        const lunarDay = offset + 1;\n\n        // \u751F\u6210\u519C\u5386\u5B57\u7B26\u4E32\n        const ganIndex = (lunarYear - 4) % 10;\n        const zhiIndex = (lunarYear - 4) % 12;\n        const yearStr = this.gan[ganIndex] + this.zhi[zhiIndex] + '\u5E74';\n        const monthStr = (isLeap ? '\u95F0' : '') + this.months[lunarMonth - 1] + '\u6708';\n        const dayStr = this.days[lunarDay - 1];\n\n        return {\n          year: lunarYear,\n          month: lunarMonth,\n          day: lunarDay,\n          isLeap: isLeap,\n          yearStr: yearStr,\n          monthStr: monthStr,\n          dayStr: dayStr,\n          fullStr: yearStr + monthStr + dayStr\n        };\n      }\n    };\n\t\n\n// \u65B0\u589E\u4FEE\u6539\uFF0C\u519C\u5386\u8F6C\u516C\u5386\uFF08\u7B80\u5316\uFF0C\u9002\u75281900-2100\u5E74\uFF09\nfunction lunar2solar(lunar) {\n  for (let y = lunar.year - 1; y <= lunar.year + 1; y++) {\n    for (let m = 1; m <= 12; m++) {\n      for (let d = 1; d <= 31; d++) {\n        const date = new Date(y, m - 1, d);\n        if (date.getFullYear() !== y || date.getMonth() + 1 !== m || date.getDate() !== d) continue;\n        const l = lunarCalendar.solar2lunar(y, m, d);\n        if (\n          l &&\n          l.year === lunar.year &&\n          l.month === lunar.month &&\n          l.day === lunar.day &&\n          l.isLeap === lunar.isLeap\n        ) {\n          return { year: y, month: m, day: d };\n        }\n      }\n    }\n  }\n  return null;\n}\n\n// \u65B0\u589E\u4FEE\u6539\uFF0C\u519C\u5386\u52A0\u5468\u671F\uFF0C\u524D\u671F\u7248\u672C\nfunction addLunarPeriod(lunar, periodValue, periodUnit) {\n  let { year, month, day, isLeap } = lunar;\n  if (periodUnit === 'year') {\n    year += periodValue;\n    const leap = lunarCalendar.leapMonth(year);\n    if (isLeap && leap === month) {\n      isLeap = true;\n    } else {\n      isLeap = false;\n    }\n  } else if (periodUnit === 'month') {\n    let totalMonths = (year - 1900) * 12 + (month - 1) + periodValue;\n    year = Math.floor(totalMonths / 12) + 1900;\n    month = (totalMonths % 12) + 1;\n    const leap = lunarCalendar.leapMonth(year);\n    if (isLeap && leap === month) {\n      isLeap = true;\n    } else {\n      isLeap = false;\n    }\n  } else if (periodUnit === 'day') {\n    const solar = lunar2solar(lunar);\n    const date = new Date(solar.year, solar.month - 1, solar.day + periodValue);\n    return lunarCalendar.solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate());\n  }\n  let maxDay = isLeap\n    ? lunarCalendar.leapDays(year)\n    : lunarCalendar.monthDays(year, month);\n  let targetDay = Math.min(day, maxDay);\n  while (targetDay > 0) {\n    let solar = lunar2solar({ year, month, day: targetDay, isLeap });\n    if (solar) {\n      return { year, month, day: targetDay, isLeap };\n    }\n    targetDay--;\n  }\n  return { year, month, day, isLeap };\n}\n\n\n\n    // \u519C\u5386\u663E\u793A\u76F8\u5173\u51FD\u6570\n    function updateLunarDisplay(dateInputId, lunarDisplayId) {\n      const dateInput = document.getElementById(dateInputId);\n      const lunarDisplay = document.getElementById(lunarDisplayId);\n      const showLunar = document.getElementById('showLunar');\n\n      if (!dateInput.value || !showLunar.checked) {\n        lunarDisplay.classList.remove('show');\n        return;\n      }\n\n      const date = new Date(dateInput.value);\n      const lunar = lunarCalendar.solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate());\n\n      if (lunar) {\n        lunarDisplay.textContent = '\u519C\u5386\uFF1A' + lunar.fullStr;\n        lunarDisplay.classList.add('show');\n      } else {\n        lunarDisplay.classList.remove('show');\n      }\n    }\n\n    function toggleLunarDisplay() {\n      const showLunar = document.getElementById('showLunar');\n      updateLunarDisplay('startDate', 'startDateLunar');\n      updateLunarDisplay('expiryDate', 'expiryDateLunar');\n\n      // \u4FDD\u5B58\u7528\u6237\u504F\u597D\n      localStorage.setItem('showLunar', showLunar.checked);\n    }\n\n    function loadLunarPreference() {\n      const showLunar = document.getElementById('showLunar');\n      const saved = localStorage.getItem('showLunar');\n      if (saved !== null) {\n        showLunar.checked = saved === 'true';\n      } else {\n        showLunar.checked = true; // \u9ED8\u8BA4\u663E\u793A\n      }\n      toggleLunarDisplay();\n    }\n\n    // \u8D27\u5E01\u683C\u5F0F\u5316\u51FD\u6570\n    function formatCurrency(amount, currency) {\n      if (!amount || amount === 0) return null;\n      \n      const formattedAmount = parseFloat(amount).toFixed(2);\n      const currencyMap = {\n        'NTD': 'NT$ ' + formattedAmount,\n        'USD': 'US$ ' + formattedAmount,\n        'JPY': 'JP\u00A5 ' + Math.round(amount), // \u65E5\u5143\u901A\u5E38\u4E0D\u663E\u793A\u5C0F\u6570\n        'EUR': '\u20AC ' + formattedAmount,\n        'CNY': 'CN\u00A5 ' + formattedAmount\n      };\n      \n      return currencyMap[currency] || formattedAmount;\n    }\n\n    function handleListLunarToggle() {\n      const listShowLunar = document.getElementById('listShowLunar');\n      // \u4FDD\u5B58\u7528\u6237\u504F\u597D\n      localStorage.setItem('showLunar', listShowLunar.checked);\n      // \u91CD\u65B0\u52A0\u8F7D\u8BA2\u9605\u5217\u8868\u4EE5\u5E94\u7528\u519C\u5386\u663E\u793A\u8BBE\u7F6E\n      loadSubscriptions();\n    }\n\n    function showToast(message, type = 'success', duration = 3000) {\n      const container = document.getElementById('toast-container');\n      const toast = document.createElement('div');\n      toast.className = 'toast ' + type;\n      \n      const icon = type === 'success' ? 'check-circle' :\n                   type === 'error' ? 'exclamation-circle' :\n                   type === 'warning' ? 'exclamation-triangle' : 'info-circle';\n      \n      toast.innerHTML = '<div class=\"flex items-center\"><i class=\"fas fa-' + icon + ' mr-2\"></i><span>' + message + '</span></div>';\n      \n      container.appendChild(toast);\n      setTimeout(() => toast.classList.add('show'), 100);\n      setTimeout(() => {\n        toast.classList.remove('show');\n        setTimeout(() => {\n          if (container.contains(toast)) {\n            container.removeChild(toast);\n          }\n        }, 300);\n      }, duration);\n    }\n\n    function showFieldError(fieldId, message) {\n      const field = document.getElementById(fieldId);\n      const errorDiv = field.parentElement.querySelector('.error-message');\n      if (errorDiv) {\n        errorDiv.textContent = message;\n        errorDiv.classList.add('show');\n        field.classList.add('border-red-500');\n      }\n    }\n\n    function clearFieldErrors() {\n      document.querySelectorAll('.error-message').forEach(el => {\n        el.classList.remove('show');\n        el.textContent = '';\n      });\n      document.querySelectorAll('.border-red-500').forEach(el => {\n        el.classList.remove('border-red-500');\n      });\n    }\n\n    function validateForm() {\n      clearFieldErrors();\n      let isValid = true;\n\n      const name = document.getElementById('name').value.trim();\n      if (!name) {\n        showFieldError('name', '\u8BF7\u8F93\u5165\u8BA2\u9605\u540D\u79F0');\n        isValid = false;\n      }\n\n      const periodValue = document.getElementById('periodValue').value;\n      if (!periodValue || periodValue < 1) {\n        showFieldError('periodValue', '\u5468\u671F\u6570\u503C\u5FC5\u987B\u5927\u4E8E0');\n        isValid = false;\n      }\n\n      const expiryDate = document.getElementById('expiryDate').value;\n      if (!expiryDate) {\n        showFieldError('expiryDate', '\u8BF7\u9009\u62E9\u5230\u671F\u65E5\u671F');\n        isValid = false;\n      }\n\n      const reminderDays = document.getElementById('reminderDays').value;\n      if (reminderDays === '' || reminderDays < 0) {\n        showFieldError('reminderDays', '\u63D0\u9192\u5929\u6570\u4E0D\u80FD\u4E3A\u8D1F\u6570');\n        isValid = false;\n      }\n\n      // \u9A8C\u8BC1\u91D1\u989D\u5B57\u6BB5\uFF08\u53EF\u9009\uFF09\n      const amount = document.getElementById('amount').value;\n      if (amount && (isNaN(amount) || parseFloat(amount) < 0)) {\n        showFieldError('amount', '\u91D1\u989D\u5FC5\u987B\u662F\u975E\u8D1F\u6570');\n        isValid = false;\n      }\n\n      return isValid;\n    }\n\n    // \u521B\u5EFA\u5E26\u60AC\u6D6E\u63D0\u793A\u7684\u6587\u672C\u5143\u7D20\n    function createHoverText(text, maxLength = 30, className = 'text-sm text-gray-900') {\n      if (!text || text.length <= maxLength) {\n        return '<div class=\"' + className + '\">' + text + '</div>';\n      }\n\n      const truncated = text.substring(0, maxLength) + '...';\n      return '<div class=\"hover-container\">' +\n        '<div class=\"hover-text ' + className + '\" data-full-text=\"' + text.replace(/\"/g, '&quot;') + '\">' +\n          truncated +\n        '</div>' +\n        '<div class=\"hover-tooltip\"></div>' +\n      '</div>';\n    }\n\n    // \u83B7\u53D6\u6240\u6709\u8BA2\u9605\u5E76\u6309\u5230\u671F\u65F6\u95F4\u6392\u5E8F\n    async function loadSubscriptions() {\n      try {\n        // \u52A0\u8F7D\u519C\u5386\u663E\u793A\u504F\u597D\n        const listShowLunar = document.getElementById('listShowLunar');\n        const saved = localStorage.getItem('showLunar');\n        if (saved !== null) {\n          listShowLunar.checked = saved === 'true';\n        } else {\n          listShowLunar.checked = true; // \u9ED8\u8BA4\u663E\u793A\n        }\n\n        const tbody = document.getElementById('subscriptionsBody');\n        tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4\"><i class=\"fas fa-spinner fa-spin mr-2\"></i>\u52A0\u8F7D\u4E2D...</td></tr>';\n\n        console.log('[Frontend] \u5F00\u59CB\u8BF7\u6C42\u8BA2\u9605\u6570\u636E');\n        const response = await fetch('/api/subscriptions');\n        console.log('[Frontend] API\u54CD\u5E94\u72B6\u6001:', response.status, response.statusText || 'unknown');\n        \n        if (!response.ok) {\n          if (response.status === 401) {\n            console.log('[Frontend] \u672A\u6388\u6743\uFF0C\u91CD\u5B9A\u5411\u5230\u767B\u5F55\u9875');\n            window.location.href = '/';\n            return;\n          }\n          \n          const errorData = await response.json().catch(() => ({ message: '\u672A\u77E5\u9519\u8BEF' }));\n          console.error('[Frontend] API\u8FD4\u56DE\u9519\u8BEF:', errorData);\n          tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-red-500\">\u52A0\u8F7D\u5931\u8D25: ' + (errorData.message || 'HTTP ' + response.status) + '</td></tr>';\n          return;\n        }\n        \n        const data = await response.json();\n        console.log('[Frontend] \u6536\u5230\u8BA2\u9605\u6570\u636E\u6570\u91CF:', data.length);\n        \n        // \u4FDD\u5B58\u539F\u59CB\u6570\u636E\u4EE5\u4F9B\u7B5B\u9009\u4F7F\u7528\n        window.allSubscriptions = data;\n        \n        // \u66F4\u65B0\u7C7B\u578B\u7B5B\u9009\u5668\n        updateTypeFilter(data);\n\n        if (data.length === 0) {\n          tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-gray-500\">\u6CA1\u6709\u8BA2\u9605\u6570\u636E</td></tr>';\n          return;\n        }\n        \n        // \u5E94\u7528\u5F53\u524D\u7B5B\u9009\n        applyCurrentFilter();\n        \n      } catch (error) {\n        console.error('[Frontend] \u52A0\u8F7D\u8BA2\u9605\u5931\u8D25:', error);\n        const tbody = document.getElementById('subscriptionsBody');\n        tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-red-500\">\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u8FDE\u63A5\u5E76\u5237\u65B0\u9875\u9762\u91CD\u8BD5</td></tr>';\n      }\n    }\n\n    // \u66F4\u65B0\u7C7B\u578B\u7B5B\u9009\u5668\u9009\u9879\n    function updateTypeFilter(subscriptions) {\n      const typeFilter = document.getElementById('typeFilter');\n      const currentValue = typeFilter.value;\n      \n      // \u83B7\u53D6\u6240\u6709\u552F\u4E00\u7684\u8BA2\u9605\u7C7B\u578B\n      const types = [...new Set(subscriptions.map(sub => sub.customType || '\u5176\u4ED6').filter(type => type))];\n      types.sort();\n      \n      // \u6E05\u7A7A\u73B0\u6709\u9009\u9879\uFF08\u9664\u4E86\"\u5168\u90E8\"\uFF09\n      typeFilter.innerHTML = '<option value=\"\">\u5168\u90E8</option>';\n      \n      // \u6DFB\u52A0\u7C7B\u578B\u9009\u9879\n      types.forEach(type => {\n        const option = document.createElement('option');\n        option.value = type;\n        option.textContent = type;\n        typeFilter.appendChild(option);\n      });\n      \n      // \u6062\u590D\u4E4B\u524D\u7684\u9009\u62E9\n      typeFilter.value = currentValue;\n    }\n\n    // \u5E94\u7528\u5F53\u524D\u7B5B\u9009\n    function applyCurrentFilter() {\n      const typeFilter = document.getElementById('typeFilter');\n      const selectedType = typeFilter.value;\n      \n      let filteredData = window.allSubscriptions || [];\n      \n      // \u6839\u636E\u9009\u4E2D\u7684\u7C7B\u578B\u8FDB\u884C\u7B5B\u9009\n      if (selectedType) {\n        filteredData = filteredData.filter(sub => (sub.customType || '\u5176\u4ED6') === selectedType);\n      }\n      \n      renderSubscriptions(filteredData);\n    }\n\n    // \u6E32\u67D3\u8BA2\u9605\u5217\u8868\n    function renderSubscriptions(data) {\n      const tbody = document.getElementById('subscriptionsBody');\n      tbody.innerHTML = '';\n      \n      if (data.length === 0) {\n        tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-gray-500\">\u6CA1\u6709\u7B26\u5408\u6761\u4EF6\u7684\u8BA2\u9605\u6570\u636E</td></tr>';\n        return;\n      }\n      \n      // \u6309\u5230\u671F\u65F6\u95F4\u5347\u5E8F\u6392\u5E8F\uFF08\u6700\u65E9\u5230\u671F\u7684\u5728\u524D\uFF09\n      data.sort((a, b) => new Date(a.expiryDate) - new Date(b.expiryDate));\n        \n\t\t//\u65B0\u589E\u4FEE\u6539\uFF0C\u6DFB\u52A0\u65E5\u5386\u7C7B\u578B\n        data.forEach(subscription => {\n          const row = document.createElement('tr');\n          row.className = subscription.isActive === false ? 'hover:bg-gray-50 bg-gray-100' : 'hover:bg-gray-50';\n          \n\t\t  // \u65B0\u589E\u4FEE\u6539\uFF1A\u65E5\u5386\u7C7B\u578B\u663E\u793A\n\t\t  let calendarTypeHtml = '';\n\t\t  if (subscription.useLunar) {\n\t\t\tcalendarTypeHtml = '<div class=\"text-xs text-purple-600 mt-1\">\u65E5\u5386\u7C7B\u578B\uFF1A\u519C\u5386</div>';\n\t\t  } else {\n\t\t\tcalendarTypeHtml = '<div class=\"text-xs text-gray-600 mt-1\">\u65E5\u5386\u7C7B\u578B\uFF1A\u516C\u5386</div>';\n\t\t  }\n\t\t  \n          const expiryDate = new Date(subscription.expiryDate);\n          const now = new Date();\n          const daysDiff = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));\n          \n          let statusHtml = '';\n          if (!subscription.isActive) {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-gray-500\"><i class=\"fas fa-pause-circle mr-1\"></i>\u5DF2\u505C\u7528</span>';\n          } else if (daysDiff < 0) {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-red-500\"><i class=\"fas fa-exclamation-circle mr-1\"></i>\u5DF2\u8FC7\u671F</span>';\n          } else if (daysDiff <= (subscription.reminderDays || 7)) {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-yellow-500\"><i class=\"fas fa-exclamation-triangle mr-1\"></i>\u5373\u5C06\u5230\u671F</span>';\n          } else {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-green-500\"><i class=\"fas fa-check-circle mr-1\"></i>\u6B63\u5E38</span>';\n          }\n          \n          let periodText = '';\n          if (subscription.periodValue && subscription.periodUnit) {\n            const unitMap = { day: '\u5929', month: '\u6708', year: '\u5E74' };\n            periodText = subscription.periodValue + ' ' + (unitMap[subscription.periodUnit] || subscription.periodUnit);\n          }\n          \n          const autoRenewIcon = subscription.autoRenew !== false ? \n            '<i class=\"fas fa-sync-alt text-blue-500 ml-1\" title=\"\u81EA\u52A8\u7EED\u8BA2\"></i>' : \n            '<i class=\"fas fa-ban text-gray-400 ml-1\" title=\"\u4E0D\u81EA\u52A8\u7EED\u8BA2\"></i>';\n          \n          // \u68C0\u67E5\u662F\u5426\u663E\u793A\u519C\u5386\n          const showLunar = document.getElementById('listShowLunar').checked;\n          let lunarExpiryText = '';\n          let startLunarText = '';\n\n          if (showLunar) {\n            // \u8BA1\u7B97\u519C\u5386\u65E5\u671F\n            const expiryDateObj = new Date(subscription.expiryDate);\n            const lunarExpiry = lunarCalendar.solar2lunar(expiryDateObj.getFullYear(), expiryDateObj.getMonth() + 1, expiryDateObj.getDate());\n            lunarExpiryText = lunarExpiry ? lunarExpiry.fullStr : '';\n\n            if (subscription.startDate) {\n              const startDateObj = new Date(subscription.startDate);\n              const lunarStart = lunarCalendar.solar2lunar(startDateObj.getFullYear(), startDateObj.getMonth() + 1, startDateObj.getDate());\n              startLunarText = lunarStart ? lunarStart.fullStr : '';\n            }\n          }\n\n          // \u5904\u7406\u5907\u6CE8\u663E\u793A\n          let notesHtml = '';\n          if (subscription.notes) {\n            const notes = subscription.notes;\n            if (notes.length > 50) {\n              const truncatedNotes = notes.substring(0, 50) + '...';\n              notesHtml = '<div class=\"notes-container\">' +\n                '<div class=\"notes-text text-xs text-gray-500\" data-full-notes=\"' + notes.replace(/\"/g, '&quot;') + '\">' +\n                  truncatedNotes +\n                '</div>' +\n                '<div class=\"notes-tooltip\"></div>' +\n              '</div>';\n            } else {\n              notesHtml = '<div class=\"text-xs text-gray-500\">' + notes + '</div>';\n            }\n          }\n\n\t\t  // \u751F\u6210\u5404\u5217\u5185\u5BB9\n\t\t  const nameHtml = createHoverText(subscription.name, 20, 'text-sm font-medium text-gray-900');\n\t\t  const typeHtml = createHoverText((subscription.customType || '\u5176\u4ED6'), 15, 'text-sm text-gray-900');\n\t\t  const periodHtml = periodText ? createHoverText('\u5468\u671F: ' + periodText, 20, 'text-xs text-gray-500 mt-1') : '';\n\n          // \u5230\u671F\u65F6\u95F4\u76F8\u5173\u4FE1\u606F\n          const expiryDateText = formatBeijingTime(new Date(subscription.expiryDate), 'date');\n          const lunarHtml = lunarExpiryText ? createHoverText('\u519C\u5386: ' + lunarExpiryText, 25, 'text-xs text-blue-600 mt-1') : '';\n          const daysLeftText = daysDiff < 0 ? '\u5DF2\u8FC7\u671F' + Math.abs(daysDiff) + '\u5929' : '\u8FD8\u5269' + daysDiff + '\u5929';\n          const startDateText = subscription.startDate ?\n            '\u5F00\u59CB: ' + formatBeijingTime(new Date(subscription.startDate), 'date') + (startLunarText ? ' (' + startLunarText + ')' : '') : '';\n          const startDateHtml = startDateText ? createHoverText(startDateText, 30, 'text-xs text-gray-500 mt-1') : '';\n\n\t\t  // \u751F\u6210\u91D1\u989D\u663E\u793A\n\t\t  let amountHtml = '';\n\t\t  if (subscription.amount && subscription.amount > 0) {\n\t\t\tconst formattedAmount = formatCurrency(subscription.amount, subscription.currency);\n\t\t\tif (formattedAmount) {\n\t\t\t  amountHtml = '<div class=\"text-sm text-gray-900\">' + formattedAmount + '</div>';\n\t\t\t}\n\t\t  }\n\t\t  if (!amountHtml) {\n\t\t\tamountHtml = '<div class=\"text-sm text-gray-400\">-</div>';\n\t\t  }\n\n\t\t  //\u65B0\u589E\u4FEE\u6539\uFF0C\u4FEE\u6539\u65E5\u5386\u7C7B\u578B\n\t\t  row.innerHTML =\n\t\t\t'<td data-label=\"\u540D\u79F0\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  nameHtml +\n\t\t\t  notesHtml +\n\t\t\t'</div></td>' +\n\t\t\t'<td data-label=\"\u7C7B\u578B\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  '<div class=\"flex items-center\"><i class=\"fas fa-tag mr-1\"></i><span>' + typeHtml + '</span></div>' +\n\t\t\t  (periodHtml ? '<div class=\"flex items-center\">' + periodHtml + autoRenewIcon + '</div>' : '') +\n\t\t\t  calendarTypeHtml + // \u65B0\u589E\uFF1A\u65E5\u5386\u7C7B\u578B\n\t\t\t'</div></td>' +\n\t\t\t'<td data-label=\"\u5230\u671F\u65F6\u95F4\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  '<div class=\"text-sm text-gray-900\">' + expiryDateText + '</div>' +\n\t\t\t  lunarHtml +\n\t\t\t  '<div class=\"text-xs text-gray-500 mt-1\">' + daysLeftText + '</div>' +\n\t\t\t  startDateHtml +\n\t\t\t'</div></td>' +\n\t\t\t'<td data-label=\"\u91D1\u989D\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  amountHtml +\n\t\t\t'</div></td>' +\n\t\t\t'<td data-label=\"\u63D0\u9192\u8BBE\u7F6E\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  '<div><i class=\"fas fa-bell mr-1\"></i>\u63D0\u524D' + (subscription.reminderDays || 0) + '\u5929</div>' +\n\t\t\t  (subscription.reminderDays === 0 ? '<div class=\"text-xs text-gray-500 mt-1\">\u4EC5\u5230\u671F\u65E5\u63D0\u9192</div>' : '') +\n\t\t\t'</div></td>' +\n\t\t\t'<td data-label=\"\u72B6\u6001\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  statusHtml +\n\t\t\t'</div></td>' +\n\t\t\t'<td data-label=\"\u64CD\u4F5C\" class=\"px-4 py-3\"><div class=\"td-content-wrapper\">' +\n\t\t\t  '<div class=\"action-buttons-wrapper space-x-1\">' +\n\t\t\t\t'<button class=\"edit btn-primary text-white px-2 py-1 rounded text-xs whitespace-nowrap\" data-id=\"' + subscription.id + '\"><i class=\"fas fa-edit mr-1\"></i>\u7F16\u8F91</button>' +\n\t\t\t\t'<button class=\"test-notify btn-info text-white px-2 py-1 rounded text-xs whitespace-nowrap\" data-id=\"' + subscription.id + '\"><i class=\"fas fa-paper-plane mr-1\"></i>\u6D4B\u8BD5</button>' +\n\t\t\t\t'<button class=\"delete btn-danger text-white px-2 py-1 rounded text-xs whitespace-nowrap\" data-id=\"' + subscription.id + '\"><i class=\"fas fa-trash-alt mr-1\"></i>\u5220\u9664</button>' +\n\t\t\t\t(subscription.isActive ?\n\t\t\t\t  '<button class=\"toggle-status btn-warning text-white px-2 py-1 rounded text-xs whitespace-nowrap\" data-id=\"' + subscription.id + '\" data-action=\"deactivate\"><i class=\"fas fa-pause-circle mr-1\"></i>\u505C\u7528</button>' :\n\t\t\t\t  '<button class=\"toggle-status btn-success text-white px-2 py-1 rounded text-xs whitespace-nowrap\" data-id=\"' + subscription.id + '\" data-action=\"activate\"><i class=\"fas fa-play-circle mr-1\"></i>\u542F\u7528</button>') +\n\t\t\t  '</div>' +\n\t\t\t'</td>';\n\n\t\t  tbody.appendChild(row);\n        });\n        \n        // \u91CD\u65B0\u7ED1\u5B9A\u4E8B\u4EF6\u76D1\u542C\u5668\n        document.querySelectorAll('.edit').forEach(button => {\n          button.addEventListener('click', editSubscription);\n        });\n        \n        document.querySelectorAll('.delete').forEach(button => {\n          button.addEventListener('click', deleteSubscription);\n        });\n        \n        document.querySelectorAll('.toggle-status').forEach(button => {\n          button.addEventListener('click', toggleSubscriptionStatus);\n        });\n\n        document.querySelectorAll('.test-notify').forEach(button => {\n          button.addEventListener('click', testSubscriptionNotification);\n        });\n\n        // \u6DFB\u52A0\u60AC\u505C\u529F\u80FD\n        addHoverListeners();\n    }\n\n    // \u6DFB\u52A0\u60AC\u505C\u529F\u80FD\n    function addHoverListeners() {\n      // \u8BA1\u7B97\u60AC\u6D6E\u63D0\u793A\u4F4D\u7F6E\n      function positionTooltip(element, tooltip) {\n        const rect = element.getBoundingClientRect();\n        const tooltipHeight = 100; // \u9884\u4F30\u9AD8\u5EA6\n        const viewportHeight = window.innerHeight;\n        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n        let top = rect.bottom + scrollTop + 8;\n        let left = rect.left;\n\n        // \u5982\u679C\u4E0B\u65B9\u7A7A\u95F4\u4E0D\u591F\uFF0C\u663E\u793A\u5728\u4E0A\u65B9\n        if (rect.bottom + tooltipHeight > viewportHeight) {\n          top = rect.top + scrollTop - tooltipHeight - 8;\n          tooltip.style.transform = 'translateY(10px)';\n          // \u8C03\u6574\u7BAD\u5934\u4F4D\u7F6E\n          tooltip.classList.add('tooltip-above');\n        } else {\n          tooltip.style.transform = 'translateY(-10px)';\n          tooltip.classList.remove('tooltip-above');\n        }\n\n        // \u786E\u4FDD\u4E0D\u8D85\u51FA\u53F3\u8FB9\u754C\n        const maxLeft = window.innerWidth - 320 - 20;\n        if (left > maxLeft) {\n          left = maxLeft;\n        }\n\n        tooltip.style.left = left + 'px';\n        tooltip.style.top = top + 'px';\n      }\n\n      // \u5907\u6CE8\u60AC\u505C\u529F\u80FD\n      document.querySelectorAll('.notes-text').forEach(notesElement => {\n        const fullNotes = notesElement.getAttribute('data-full-notes');\n        const tooltip = notesElement.parentElement.querySelector('.notes-tooltip');\n\n        if (fullNotes && tooltip) {\n          notesElement.addEventListener('mouseenter', () => {\n            tooltip.textContent = fullNotes;\n            positionTooltip(notesElement, tooltip);\n            tooltip.classList.add('show');\n          });\n\n          notesElement.addEventListener('mouseleave', () => {\n            tooltip.classList.remove('show');\n          });\n\n          // \u6EDA\u52A8\u65F6\u9690\u85CF\u63D0\u793A\n          window.addEventListener('scroll', () => {\n            if (tooltip.classList.contains('show')) {\n              tooltip.classList.remove('show');\n            }\n          }, { passive: true });\n        }\n      });\n\n      // \u901A\u7528\u60AC\u505C\u529F\u80FD\n      document.querySelectorAll('.hover-text').forEach(hoverElement => {\n        const fullText = hoverElement.getAttribute('data-full-text');\n        const tooltip = hoverElement.parentElement.querySelector('.hover-tooltip');\n\n        if (fullText && tooltip) {\n          hoverElement.addEventListener('mouseenter', () => {\n            tooltip.textContent = fullText;\n            positionTooltip(hoverElement, tooltip);\n            tooltip.classList.add('show');\n          });\n\n          hoverElement.addEventListener('mouseleave', () => {\n            tooltip.classList.remove('show');\n          });\n\n          // \u6EDA\u52A8\u65F6\u9690\u85CF\u63D0\u793A\n          window.addEventListener('scroll', () => {\n            if (tooltip.classList.contains('show')) {\n              tooltip.classList.remove('show');\n            }\n          }, { passive: true });\n        }\n      });\n    }\n        \n\t\t//\u65B0\u589E\u4FEE\u6539\uFF0C\u6DFB\u52A0\u65E5\u5386\u7C7B\u578B\n        data.forEach(subscription => {\n          const row = document.createElement('tr');\n          row.className = subscription.isActive === false ? 'hover:bg-gray-50 bg-gray-100' : 'hover:bg-gray-50';\n          \n\t\t  // \u65B0\u589E\u4FEE\u6539\uFF1A\u65E5\u5386\u7C7B\u578B\u663E\u793A\n\t\t  let calendarTypeHtml = '';\n\t\t  if (subscription.useLunar) {\n\t\t\tcalendarTypeHtml = '<div class=\"text-xs text-purple-600 mt-1\">\u65E5\u5386\u7C7B\u578B\uFF1A\u519C\u5386</div>';\n\t\t  } else {\n\t\t\tcalendarTypeHtml = '<div class=\"text-xs text-gray-600 mt-1\">\u65E5\u5386\u7C7B\u578B\uFF1A\u516C\u5386</div>';\n\t\t  }\n\t\t  \n          const expiryDate = new Date(subscription.expiryDate);\n          const now = new Date();\n          const daysDiff = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));\n          \n          let statusHtml = '';\n          if (!subscription.isActive) {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-gray-500\"><i class=\"fas fa-pause-circle mr-1\"></i>\u5DF2\u505C\u7528</span>';\n          } else if (daysDiff < 0) {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-red-500\"><i class=\"fas fa-exclamation-circle mr-1\"></i>\u5DF2\u8FC7\u671F</span>';\n          } else if (daysDiff <= (subscription.reminderDays || 7)) {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-yellow-500\"><i class=\"fas fa-exclamation-triangle mr-1\"></i>\u5373\u5C06\u5230\u671F</span>';\n          } else {\n            statusHtml = '<span class=\"px-2 py-1 text-xs font-medium rounded-full text-white bg-green-500\"><i class=\"fas fa-check-circle mr-1\"></i>\u6B63\u5E38</span>';\n          }\n          \n          let periodText = '';\n          if (subscription.periodValue && subscription.periodUnit) {\n            const unitMap = { day: '\u5929', month: '\u6708', year: '\u5E74' };\n            periodText = subscription.periodValue + ' ' + (unitMap[subscription.periodUnit] || subscription.periodUnit);\n          }\n          \n          const autoRenewIcon = subscription.autoRenew !== false ? \n            '<i class=\"fas fa-sync-alt text-blue-500 ml-1\" title=\"\u81EA\u52A8\u7EED\u8BA2\"></i>' : \n            '<i class=\"fas fa-ban text-gray-400 ml-1\" title=\"\u4E0D\u81EA\u52A8\u7EED\u8BA2\"></i>';\n          \n          // \u68C0\u67E5\u662F\u5426\u663E\u793A\u519C\u5386\n          const showLunar = document.getElementById('listShowLunar').checked;\n          let lunarExpiryText = '';\n          let startLunarText = '';\n\n          if (showLunar) {\n            // \u8BA1\u7B97\u519C\u5386\u65E5\u671F\n            const expiryDateObj = new Date(subscription.expiryDate);\n            const lunarExpiry = lunarCalendar.solar2lunar(expiryDateObj.getFullYear(), expiryDateObj.getMonth() + 1, expiryDateObj.getDate());\n            lunarExpiryText = lunarExpiry ? lunarExpiry.fullStr : '';\n\n            if (subscription.startDate) {\n              const startDateObj = new Date(subscription.startDate);\n              const lunarStart = lunarCalendar.solar2lunar(startDateObj.getFullYear(), startDateObj.getMonth() + 1, startDateObj.getDate());\n              startLunarText = lunarStart ? lunarStart.fullStr : '';\n            }\n          }\n\n          // \u5904\u7406\u5907\u6CE8\u663E\u793A\n          let notesHtml = '';\n          if (subscription.notes) {\n            const notes = subscription.notes;\n            if (notes.length > 50) {\n              const truncatedNotes = notes.substring(0, 50) + '...';\n              notesHtml = '<div class=\"notes-container\">' +\n                '<div class=\"notes-text text-xs text-gray-500\" data-full-notes=\"' + notes.replace(/\"/g, '&quot;') + '\">' +\n                  truncatedNotes +\n                '</div>' +\n                '<div class=\"notes-tooltip\"></div>' +\n              '</div>';\n            } else {\n              notesHtml = '<div class=\"text-xs text-gray-500\">' + notes + '</div>';\n            }\n          }\n\n        // \u6DFB\u52A0\u60AC\u505C\u529F\u80FD\n        function addHoverListeners() {\n          // \u8BA1\u7B97\u60AC\u6D6E\u63D0\u793A\u4F4D\u7F6E\n          function positionTooltip(element, tooltip) {\n            const rect = element.getBoundingClientRect();\n            const tooltipHeight = 100; // \u9884\u4F30\u9AD8\u5EA6\n            const viewportHeight = window.innerHeight;\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n            let top = rect.bottom + scrollTop + 8;\n            let left = rect.left;\n\n            // \u5982\u679C\u4E0B\u65B9\u7A7A\u95F4\u4E0D\u591F\uFF0C\u663E\u793A\u5728\u4E0A\u65B9\n            if (rect.bottom + tooltipHeight > viewportHeight) {\n              top = rect.top + scrollTop - tooltipHeight - 8;\n              tooltip.style.transform = 'translateY(10px)';\n              // \u8C03\u6574\u7BAD\u5934\u4F4D\u7F6E\n              tooltip.classList.add('tooltip-above');\n            } else {\n              tooltip.style.transform = 'translateY(-10px)';\n              tooltip.classList.remove('tooltip-above');\n            }\n\n            // \u786E\u4FDD\u4E0D\u8D85\u51FA\u53F3\u8FB9\u754C\n            const maxLeft = window.innerWidth - 320 - 20;\n            if (left > maxLeft) {\n              left = maxLeft;\n            }\n\n            tooltip.style.left = left + 'px';\n            tooltip.style.top = top + 'px';\n          }\n\n          // \u5907\u6CE8\u60AC\u505C\u529F\u80FD\n          document.querySelectorAll('.notes-text').forEach(notesElement => {\n            const fullNotes = notesElement.getAttribute('data-full-notes');\n            const tooltip = notesElement.parentElement.querySelector('.notes-tooltip');\n\n            if (fullNotes && tooltip) {\n              notesElement.addEventListener('mouseenter', () => {\n                tooltip.textContent = fullNotes;\n                positionTooltip(notesElement, tooltip);\n                tooltip.classList.add('show');\n              });\n\n              notesElement.addEventListener('mouseleave', () => {\n                tooltip.classList.remove('show');\n              });\n\n              // \u6EDA\u52A8\u65F6\u9690\u85CF\u63D0\u793A\n              window.addEventListener('scroll', () => {\n                if (tooltip.classList.contains('show')) {\n                  tooltip.classList.remove('show');\n                }\n              }, { passive: true });\n            }\n          });\n\n          // \u901A\u7528\u60AC\u505C\u529F\u80FD\n          document.querySelectorAll('.hover-text').forEach(hoverElement => {\n            const fullText = hoverElement.getAttribute('data-full-text');\n            const tooltip = hoverElement.parentElement.querySelector('.hover-tooltip');\n\n            if (fullText && tooltip) {\n              hoverElement.addEventListener('mouseenter', () => {\n                tooltip.textContent = fullText;\n                positionTooltip(hoverElement, tooltip);\n                tooltip.classList.add('show');\n              });\n\n              hoverElement.addEventListener('mouseleave', () => {\n                tooltip.classList.remove('show');\n              });\n\n              // \u6EDA\u52A8\u65F6\u9690\u85CF\u63D0\u793A\n              window.addEventListener('scroll', () => {\n                if (tooltip.classList.contains('show')) {\n                  tooltip.classList.remove('show');\n                }\n              }, { passive: true });\n            }\n          });\n        }\n\n        addHoverListeners();\n\n        // \u6DFB\u52A0\u519C\u5386\u5F00\u5173\u4E8B\u4EF6\u76D1\u542C\n        listShowLunar.removeEventListener('change', handleListLunarToggle);\n        listShowLunar.addEventListener('change', handleListLunarToggle);\n      } catch (error) {\n        console.error('\u52A0\u8F7D\u8BA2\u9605\u5931\u8D25:', error);\n        const tbody = document.getElementById('subscriptionsBody');\n        tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-red-500\"><i class=\"fas fa-exclamation-circle mr-2\"></i>\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5</td></tr>';\n        showToast('\u52A0\u8F7D\u8BA2\u9605\u5217\u8868\u5931\u8D25', 'error');\n      }\n    }\n    \n    async function testSubscriptionNotification(e) {\n        const button = e.target.tagName === 'BUTTON' ? e.target : e.target.parentElement;\n        const id = button.dataset.id;\n        const originalContent = button.innerHTML;\n        button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-1\"></i>';\n        button.disabled = true;\n\n        try {\n            const response = await fetch('/api/subscriptions/' + id + '/test-notify', { method: 'POST' });\n            const result = await response.json();\n            if (result.success) {\n                showToast(result.message || '\u6D4B\u8BD5\u901A\u77E5\u5DF2\u53D1\u9001', 'success');\n            } else {\n                showToast(result.message || '\u6D4B\u8BD5\u901A\u77E5\u53D1\u9001\u5931\u8D25', 'error');\n            }\n        } catch (error) {\n            console.error('\u6D4B\u8BD5\u901A\u77E5\u5931\u8D25:', error);\n            showToast('\u53D1\u9001\u6D4B\u8BD5\u901A\u77E5\u65F6\u53D1\u751F\u9519\u8BEF', 'error');\n        } finally {\n            button.innerHTML = originalContent;\n            button.disabled = false;\n        }\n    }\n    \n    async function toggleSubscriptionStatus(e) {\n      const id = e.target.dataset.id || e.target.parentElement.dataset.id;\n      const action = e.target.dataset.action || e.target.parentElement.dataset.action;\n      const isActivate = action === 'activate';\n      \n      const button = e.target.tagName === 'BUTTON' ? e.target : e.target.parentElement;\n      const originalContent = button.innerHTML;\n      button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>' + (isActivate ? '\u542F\u7528\u4E2D...' : '\u505C\u7528\u4E2D...');\n      button.disabled = true;\n      \n      try {\n        const response = await fetch('/api/subscriptions/' + id + '/toggle-status', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ isActive: isActivate })\n        });\n        \n        if (response.ok) {\n          showToast((isActivate ? '\u542F\u7528' : '\u505C\u7528') + '\u6210\u529F', 'success');\n          loadSubscriptions();\n        } else {\n          const error = await response.json();\n          showToast((isActivate ? '\u542F\u7528' : '\u505C\u7528') + '\u5931\u8D25: ' + (error.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n        }\n      } catch (error) {\n        console.error((isActivate ? '\u542F\u7528' : '\u505C\u7528') + '\u8BA2\u9605\u5931\u8D25:', error);\n        showToast((isActivate ? '\u542F\u7528' : '\u505C\u7528') + '\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n        button.innerHTML = originalContent;\n        button.disabled = false;\n      }\n    }\n    \n    document.getElementById('addSubscriptionBtn').addEventListener('click', () => {\n      document.getElementById('modalTitle').textContent = '\u6DFB\u52A0\u65B0\u8BA2\u9605';\n      document.getElementById('subscriptionModal').classList.remove('hidden');\n\n      document.getElementById('subscriptionForm').reset();\n      document.getElementById('subscriptionId').value = '';\n      clearFieldErrors();\n\n      const today = new Date().toISOString().split('T')[0];\n      document.getElementById('startDate').value = today;\n      document.getElementById('reminderDays').value = '7';\n      document.getElementById('isActive').checked = true;\n      document.getElementById('autoRenew').checked = true;\n      document.getElementById('currency').value = 'NTD'; // \u8BBE\u7F6E\u9ED8\u8BA4\u8D27\u5E01\u4E3A\u53F0\u5E01\n\n      loadLunarPreference();\n      calculateExpiryDate();\n      setupModalEventListeners();\n    });\n    \n    function setupModalEventListeners() {\n      document.getElementById('calculateExpiryBtn').removeEventListener('click', calculateExpiryDate);\n      document.getElementById('calculateExpiryBtn').addEventListener('click', calculateExpiryDate);\n\t  document.getElementById('useLunar').removeEventListener('change', calculateExpiryDate);//\u65B0\u589E\u4FEE\u6539\uFF0C\n\t  document.getElementById('useLunar').addEventListener('change', calculateExpiryDate);//\u65B0\u589E\u4FEE\u6539\uFF0C\n\n      ['startDate', 'periodValue', 'periodUnit'].forEach(id => {\n        const element = document.getElementById(id);\n        element.removeEventListener('change', calculateExpiryDate);\n        element.addEventListener('change', calculateExpiryDate);\n\t\tdocument.getElementById('useLunar').removeEventListener('change', calculateExpiryDate);//\u65B0\u589E\u4FEE\u6539\uFF0C\n\t    document.getElementById('useLunar').addEventListener('change', calculateExpiryDate);//\u65B0\u589E\u4FEE\u6539\uFF0C\n      });\n\n      // \u6DFB\u52A0\u519C\u5386\u663E\u793A\u4E8B\u4EF6\u76D1\u542C\n      document.getElementById('showLunar').removeEventListener('change', toggleLunarDisplay);\n      document.getElementById('showLunar').addEventListener('change', toggleLunarDisplay);\n\n      document.getElementById('startDate').removeEventListener('change', () => updateLunarDisplay('startDate', 'startDateLunar'));\n      document.getElementById('startDate').addEventListener('change', () => updateLunarDisplay('startDate', 'startDateLunar'));\n\n      document.getElementById('expiryDate').removeEventListener('change', () => updateLunarDisplay('expiryDate', 'expiryDateLunar'));\n      document.getElementById('expiryDate').addEventListener('change', () => updateLunarDisplay('expiryDate', 'expiryDateLunar'));\n\n      document.getElementById('cancelBtn').addEventListener('click', () => {\n        document.getElementById('subscriptionModal').classList.add('hidden');\n      });\n    }\n\n\t// 3. \u65B0\u589E\u4FEE\u6539\uFF0C calculateExpiryDate \u51FD\u6570\uFF0C\u652F\u6301\u519C\u5386\u5468\u671F\u63A8\u7B97     \n\tfunction calculateExpiryDate() {\n\t  const startDate = document.getElementById('startDate').value;\n\t  const periodValue = parseInt(document.getElementById('periodValue').value);\n\t  const periodUnit = document.getElementById('periodUnit').value;\n\t  const useLunar = document.getElementById('useLunar').checked;\n\n\t  if (!startDate || !periodValue || !periodUnit) {\n\t\treturn;\n\t  }\n\n\t  if (useLunar) {\n\t\t// \u519C\u5386\u63A8\u7B97\n\t\tconst start = new Date(startDate);\n\t\tconst lunar = lunarCalendar.solar2lunar(start.getFullYear(), start.getMonth() + 1, start.getDate());\n\t\tlet nextLunar = addLunarPeriod(lunar, periodValue, periodUnit);\n\t\tconst solar = lunar2solar(nextLunar);\n\t\t//const expiry = new Date(solar.year, solar.month - 1, solar.day);\n\t\t\n\t\t  // \u4F7F\u7528\u4E0E\u516C\u5386\u76F8\u540C\u7684\u65B9\u5F0F\u521B\u5EFA\u65E5\u671F  \n  const expiry = new Date(startDate); // \u4ECE\u539F\u59CB\u65E5\u671F\u5F00\u59CB  \n  expiry.setFullYear(solar.year);  \n  expiry.setMonth(solar.month - 1);  \n  expiry.setDate(solar.day);  \n\t\tdocument.getElementById('expiryDate').value = expiry.toISOString().split('T')[0];\n\t\tconsole.log('start:', start);\n\t\tconsole.log('nextLunar:', nextLunar);\n\t\tconsole.log('expiry:', expiry);\n\t\tconsole.log('expiryDate:', document.getElementById('expiryDate').value);\n\t\t\n\t\tconsole.log('solar from lunar2solar:', solar);  \n\t\tconsole.log('solar.year:', solar.year, 'solar.month:', solar.month, 'solar.day:', solar.day);\n\t\tconsole.log('expiry.getTime():', expiry.getTime());  \n\t\tconsole.log('expiry.toString():', expiry.toString());\n\t\t\n\t\t\n\t  } else {\n\t\t// \u516C\u5386\u63A8\u7B97\n\t\tconst start = new Date(startDate);\n\t\tconst expiry = new Date(start);\n\t\tif (periodUnit === 'day') {\n\t\t  expiry.setDate(start.getDate() + periodValue);\n\t\t} else if (periodUnit === 'month') {\n\t\t  expiry.setMonth(start.getMonth() + periodValue);\n\t\t} else if (periodUnit === 'year') {\n\t\t  expiry.setFullYear(start.getFullYear() + periodValue);\n\t\t}\n\t\tdocument.getElementById('expiryDate').value = expiry.toISOString().split('T')[0];\n\t\tconsole.log('start:', start);\n\t\tconsole.log('expiry:', expiry);\n\t\tconsole.log('expiryDate:', document.getElementById('expiryDate').value);\n\t  }\n\n\t  // \u66F4\u65B0\u519C\u5386\u663E\u793A\n\t  updateLunarDisplay('startDate', 'startDateLunar');\n\t  updateLunarDisplay('expiryDate', 'expiryDateLunar');\n\t}\n    \n    document.getElementById('closeModal').addEventListener('click', () => {\n      document.getElementById('subscriptionModal').classList.add('hidden');\n    });\n    \n    // \u7981\u6B62\u70B9\u51FB\u5F39\u7A97\u5916\u533A\u57DF\u5173\u95ED\u5F39\u7A97\uFF0C\u9632\u6B62\u8BEF\u64CD\u4F5C\u4E22\u5931\u5185\u5BB9\n    // document.getElementById('subscriptionModal').addEventListener('click', (event) => {\n    //   if (event.target === document.getElementById('subscriptionModal')) {\n    //     document.getElementById('subscriptionModal').classList.add('hidden');\n    //   }\n    // });\n    \n\t\n\t// 4. \u65B0\u589E\u4FEE\u6539\uFF0C\u76D1\u542C useLunar \u590D\u9009\u6846\u53D8\u5316\u65F6\u4E5F\u81EA\u52A8\u91CD\u65B0\u8BA1\u7B97\n\tdocument.getElementById('useLunar').addEventListener('change', calculateExpiryDate);   \n   // \u65B0\u589E\u4FEE\u6539\uFF0C\u8868\u5355\u63D0\u4EA4\u65F6\u5E26\u4E0A useLunar \u5B57\u6BB5\n    document.getElementById('subscriptionForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n      \n      if (!validateForm()) {\n        return;\n      }\n      \n      const id = document.getElementById('subscriptionId').value;\n      const subscription = {\n        name: document.getElementById('name').value.trim(),\n        customType: document.getElementById('customType').value.trim(),\n        notes: document.getElementById('notes').value.trim() || '',\n        amount: document.getElementById('amount').value ? parseFloat(document.getElementById('amount').value) : null, // \u65B0\u589E\uFF1A\u91D1\u989D\u5B57\u6BB5\n        currency: document.getElementById('currency').value, // \u65B0\u589E\uFF1A\u8D27\u5E01\u5B57\u6BB5\n        isActive: document.getElementById('isActive').checked,\n        autoRenew: document.getElementById('autoRenew').checked,\n        startDate: document.getElementById('startDate').value,\n        expiryDate: document.getElementById('expiryDate').value,\n        periodValue: parseInt(document.getElementById('periodValue').value),\n        periodUnit: document.getElementById('periodUnit').value,\n        reminderDays: parseInt(document.getElementById('reminderDays').value) || 0,\n\t\tuseLunar: document.getElementById('useLunar').checked // \u65B0\u589E\u4FEE\u6539\n      };\n      \n      const submitButton = e.target.querySelector('button[type=\"submit\"]');\n      const originalContent = submitButton.innerHTML;\n      submitButton.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>' + (id ? '\u66F4\u65B0\u4E2D...' : '\u4FDD\u5B58\u4E2D...');\n      submitButton.disabled = true;\n      \n      try {\n        const url = id ? '/api/subscriptions/' + id : '/api/subscriptions';\n        const method = id ? 'PUT' : 'POST';\n        \n        const response = await fetch(url, {\n          method: method,\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(subscription)\n        });\n        \n        const result = await response.json();\n        \n        if (result.success) {\n          showToast((id ? '\u66F4\u65B0' : '\u6DFB\u52A0') + '\u8BA2\u9605\u6210\u529F', 'success');\n          document.getElementById('subscriptionModal').classList.add('hidden');\n          loadSubscriptions();\n        } else {\n          showToast((id ? '\u66F4\u65B0' : '\u6DFB\u52A0') + '\u8BA2\u9605\u5931\u8D25: ' + (result.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n        }\n      } catch (error) {\n        console.error((id ? '\u66F4\u65B0' : '\u6DFB\u52A0') + '\u8BA2\u9605\u5931\u8D25:', error);\n        showToast((id ? '\u66F4\u65B0' : '\u6DFB\u52A0') + '\u8BA2\u9605\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n      } finally {\n        submitButton.innerHTML = originalContent;\n        submitButton.disabled = false;\n      }\n    });\n    \n\t// \u65B0\u589E\u4FEE\u6539\uFF0C\u7F16\u8F91\u8BA2\u9605\u65F6\u56DE\u663E useLunar \u5B57\u6BB5\n    async function editSubscription(e) {\n      const id = e.target.dataset.id || e.target.parentElement.dataset.id;\n      \n      try {\n        const response = await fetch('/api/subscriptions/' + id);\n        const subscription = await response.json();\n        \n        if (subscription) {\n          document.getElementById('modalTitle').textContent = '\u7F16\u8F91\u8BA2\u9605';\n          document.getElementById('subscriptionId').value = subscription.id;\n          document.getElementById('name').value = subscription.name;\n          document.getElementById('customType').value = subscription.customType || '';\n          document.getElementById('notes').value = subscription.notes || '';\n          document.getElementById('amount').value = subscription.amount || ''; // \u65B0\u589E\uFF1A\u91D1\u989D\u5B57\u6BB5\n          document.getElementById('currency').value = subscription.currency || 'NTD'; // \u65B0\u589E\uFF1A\u8D27\u5E01\u5B57\u6BB5\uFF0C\u9ED8\u8BA4\u53F0\u5E01\n          document.getElementById('isActive').checked = subscription.isActive !== false;\n          document.getElementById('autoRenew').checked = subscription.autoRenew !== false;\n          document.getElementById('startDate').value = subscription.startDate ? subscription.startDate.split('T')[0] : '';\n          document.getElementById('expiryDate').value = subscription.expiryDate ? subscription.expiryDate.split('T')[0] : '';\n          document.getElementById('periodValue').value = subscription.periodValue || 1;\n          document.getElementById('periodUnit').value = subscription.periodUnit || 'month';\n          document.getElementById('reminderDays').value = subscription.reminderDays !== undefined ? subscription.reminderDays : 7;\n\t\t  document.getElementById('useLunar').checked = !!subscription.useLunar; // \u65B0\u589E\u4FEE\u6539\n          \n          clearFieldErrors();\n          loadLunarPreference();\n          document.getElementById('subscriptionModal').classList.remove('hidden');\n          setupModalEventListeners();\n\n          // \u66F4\u65B0\u519C\u5386\u663E\u793A\n          setTimeout(() => {\n            updateLunarDisplay('startDate', 'startDateLunar');\n            updateLunarDisplay('expiryDate', 'expiryDateLunar');\n          }, 100);\n        }\n      } catch (error) {\n        console.error('\u83B7\u53D6\u8BA2\u9605\u4FE1\u606F\u5931\u8D25:', error);\n        showToast('\u83B7\u53D6\u8BA2\u9605\u4FE1\u606F\u5931\u8D25', 'error');\n      }\n    }\n    \n    async function deleteSubscription(e) {\n      const id = e.target.dataset.id || e.target.parentElement.dataset.id;\n      \n      if (!confirm('\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u8BA2\u9605\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u6062\u590D\u3002')) {\n        return;\n      }\n      \n      const button = e.target.tagName === 'BUTTON' ? e.target : e.target.parentElement;\n      const originalContent = button.innerHTML;\n      button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u5220\u9664\u4E2D...';\n      button.disabled = true;\n      \n      try {\n        const response = await fetch('/api/subscriptions/' + id, {\n          method: 'DELETE'\n        });\n        \n        if (response.ok) {\n          showToast('\u5220\u9664\u6210\u529F', 'success');\n          loadSubscriptions();\n        } else {\n          const error = await response.json();\n          showToast('\u5220\u9664\u5931\u8D25: ' + (error.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n        }\n      } catch (error) {\n        console.error('\u5220\u9664\u8BA2\u9605\u5931\u8D25:', error);\n        showToast('\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n        button.innerHTML = originalContent;\n        button.disabled = false;\n      }\n    }\n    \n    window.addEventListener('load', loadSubscriptions);\n    \n    // \u6DFB\u52A0\u7C7B\u578B\u7B5B\u9009\u5668\u4E8B\u4EF6\u76D1\u542C\n    window.addEventListener('load', function() {\n      const typeFilter = document.getElementById('typeFilter');\n      if (typeFilter) {\n        typeFilter.addEventListener('change', applyCurrentFilter);\n      }\n    });\n  </script>\n  \n  <script>\n    // Ensure subscription data loads even if other scripts fail\n    document.addEventListener('DOMContentLoaded', function() {\n      var tbody = document.getElementById('subscriptionsBody');\n      if (!tbody) return;\n      \n      tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4\">\u52A0\u8F7D\u4E2D...</td></tr>';\n      \n      fetch('/api/subscriptions')\n        .then(function(response) {\n          if (!response.ok) {\n            if (response.status === 401) {\n              window.location.href = '/';\n              return;\n            }\n            throw new Error('HTTP ' + response.status);\n          }\n          return response.json();\n        })\n        .then(function(data) {\n          if (!data || data.length === 0) {\n            tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-gray-500\">\u6CA1\u6709\u8BA2\u9605\u6570\u636E</td></tr>';\n            return;\n          }\n          \n          var html = '';\n          data.forEach(function(sub) {\n            html += '<tr>';\n            html += '<td class=\"py-3 px-6 text-left\">' + (sub.name || 'N/A') + '</td>';\n            html += '<td class=\"py-3 px-6 text-left\">' + (sub.customType || '\u5176\u4ED6') + '</td>';\n            html += '<td class=\"py-3 px-6 text-left\">' + (sub.expiryDate || 'N/A') + '</td>';\n            html += '<td class=\"py-3 px-6 text-left\">' + (sub.amount ? sub.amount + ' ' + (sub.currency || 'NTD') : '-') + '</td>';\n            html += '<td class=\"py-3 px-6 text-left\">' + (sub.reminderDays || 7) + '\u5929\u524D</td>';\n            html += '<td class=\"py-3 px-6 text-left\">' + (sub.isActive !== false ? '\u542F\u7528' : '\u505C\u7528') + '</td>';\n            html += '<td class=\"py-3 px-6 text-left\">\u64CD\u4F5C</td>';\n            html += '</tr>';\n          });\n          tbody.innerHTML = html;\n        })\n        .catch(function(error) {\n          tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center py-4 text-red-500\">\u52A0\u8F7D\u5931\u8D25: ' + error.message + '</td></tr>';\n        });\n    });\n  </script>\n</body>\n</html>\n`;\n\nconst configPage = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>\u7CFB\u7EDF\u914D\u7F6E - \u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</title>\n  <link href=\"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css\" rel=\"stylesheet\">\n  <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\" rel=\"stylesheet\">\n  <style>\n    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); transition: all 0.3s; }\n    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    .btn-secondary { background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); transition: all 0.3s; }\n    .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }\n    \n    .toast {\n      position: fixed; top: 20px; right: 20px; padding: 12px 20px; border-radius: 8px;\n      color: white; font-weight: 500; z-index: 1000; transform: translateX(400px);\n      transition: all 0.3s ease-in-out; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    }\n    .toast.show { transform: translateX(0); }\n    .toast.success { background-color: #10b981; }\n    .toast.error { background-color: #ef4444; }\n    .toast.info { background-color: #3b82f6; }\n    .toast.warning { background-color: #f59e0b; }\n    \n    .config-section { \n      border: 1px solid #e5e7eb; \n      border-radius: 8px; \n      padding: 16px; \n      margin-bottom: 24px; \n    }\n    .config-section.active { \n      background-color: #f8fafc; \n      border-color: #6366f1; \n    }\n    .config-section.inactive { \n      background-color: #f9fafb; \n      opacity: 0.7; \n    }\n  </style>\n</head>\n<body class=\"bg-gray-100 min-h-screen\">\n  <div id=\"toast-container\"></div>\n\n  <nav class=\"bg-white shadow-md\">\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n      <div class=\"flex justify-between h-16\">\n        <div class=\"flex items-center\">\n          <i class=\"fas fa-calendar-check text-indigo-600 text-2xl mr-2\"></i>\n          <span class=\"font-bold text-xl text-gray-800\">\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF</span>\n        </div>\n        <div class=\"flex items-center space-x-4\">\n          <a href=\"/admin\" class=\"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-list mr-1\"></i>\u8BA2\u9605\u5217\u8868\n          </a>\n          <a href=\"/admin/config\" class=\"text-indigo-600 border-b-2 border-indigo-600 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-cog mr-1\"></i>\u7CFB\u7EDF\u914D\u7F6E\n          </a>\n          <a href=\"/api/logout\" class=\"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-sign-out-alt mr-1\"></i>\u9000\u51FA\u767B\u5F55\n          </a>\n        </div>\n      </div>\n    </div>\n  </nav>\n  \n  <div class=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n    <div class=\"bg-white rounded-lg shadow-md p-6\">\n      <h2 class=\"text-2xl font-bold text-gray-800 mb-6\">\u7CFB\u7EDF\u914D\u7F6E</h2>\n      \n      <form id=\"configForm\" class=\"space-y-8\">\n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u7BA1\u7406\u5458\u8D26\u6237</h3>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <label for=\"adminUsername\" class=\"block text-sm font-medium text-gray-700\">\u7528\u6237\u540D</label>\n              <input type=\"text\" id=\"adminUsername\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n            </div>\n            <div>\n              <label for=\"adminPassword\" class=\"block text-sm font-medium text-gray-700\">\u5BC6\u7801</label>\n              <input type=\"password\" id=\"adminPassword\" placeholder=\"\u5982\u4E0D\u4FEE\u6539\u5BC6\u7801\uFF0C\u8BF7\u7559\u7A7A\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              <p class=\"mt-1 text-sm text-gray-500\">\u7559\u7A7A\u8868\u793A\u4E0D\u4FEE\u6539\u5F53\u524D\u5BC6\u7801</p>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u663E\u793A\u8BBE\u7F6E</h3>\n          <div class=\"mb-6\">\n            <label class=\"inline-flex items-center\">\n              <input type=\"checkbox\" id=\"showLunarGlobal\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\" checked>\n              <span class=\"ml-2 text-sm text-gray-700\">\u5728\u901A\u77E5\u4E2D\u663E\u793A\u519C\u5386\u65E5\u671F</span>\n            </label>\n            <p class=\"mt-1 text-sm text-gray-500\">\u63A7\u5236\u662F\u5426\u5728\u901A\u77E5\u6D88\u606F\u4E2D\u5305\u542B\u519C\u5386\u65E5\u671F\u4FE1\u606F</p>\n          </div>\n        </div>\n\n        <div class=\"border-b border-gray-200 pb-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">\u901A\u77E5\u8BBE\u7F6E</h3>\n          <div class=\"mb-6\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-3\">\u901A\u77E5\u65B9\u5F0F\uFF08\u53EF\u591A\u9009\uFF09</label>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"telegram\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">Telegram</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"notifyx\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\" checked>\n                <span class=\"ml-2 text-sm text-gray-700 font-semibold\">NotifyX</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"webhook\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"wechatbot\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA</span>\n              </label>\n              <label class=\"inline-flex items-center\">\n                <input type=\"checkbox\" name=\"enabledNotifiers\" value=\"email\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                <span class=\"ml-2 text-sm text-gray-700\">\u90AE\u4EF6\u901A\u77E5</span>\n              </label>\n            </div>\n            <div class=\"mt-2 flex flex-wrap gap-4\">\n              <a href=\"https://www.notifyx.cn/\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> NotifyX\u5B98\u7F51\n              </a>\n              <a href=\"https://push.wangwangit.com\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u5B98\u7F51\n              </a>\n              <a href=\"https://developer.work.weixin.qq.com/document/path/91770\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> \u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u6587\u6863\n              </a>\n              <a href=\"https://developers.cloudflare.com/workers/tutorials/send-emails-with-resend/\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800 text-sm\">\n                <i class=\"fas fa-external-link-alt ml-1\"></i> \u83B7\u53D6 Resend API Key\n              </a>\n            </div>\n          </div>\n          \n          <div id=\"telegramConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">Telegram \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n              <div>\n                <label for=\"tgBotToken\" class=\"block text-sm font-medium text-gray-700\">Bot Token</label>\n                <input type=\"text\" id=\"tgBotToken\" placeholder=\"\u4ECE @BotFather \u83B7\u53D6\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n              <div>\n                <label for=\"tgChatId\" class=\"block text-sm font-medium text-gray-700\">Chat ID</label>\n                <input type=\"text\" id=\"tgChatId\" placeholder=\"\u53EF\u4ECE @userinfobot \u83B7\u53D6\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testTelegramBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 Telegram \u901A\u77E5\n              </button>\n            </div>\n          </div>\n          \n          <div id=\"notifyxConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">NotifyX \u914D\u7F6E</h4>\n            <div class=\"mb-4\">\n              <label for=\"notifyxApiKey\" class=\"block text-sm font-medium text-gray-700\">API Key</label>\n              <input type=\"text\" id=\"notifyxApiKey\" placeholder=\"\u4ECE NotifyX \u5E73\u53F0\u83B7\u53D6\u7684 API Key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n              <p class=\"mt-1 text-sm text-gray-500\">\u4ECE <a href=\"https://www.notifyx.cn/\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800\">NotifyX\u5E73\u53F0</a> \u83B7\u53D6\u7684 API Key</p>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testNotifyXBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 NotifyX \u901A\u77E5\n              </button>\n            </div>\n          </div>\n\n          <div id=\"webhookConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 gap-4 mb-4\">\n              <div>\n                <label for=\"webhookUrl\" class=\"block text-sm font-medium text-gray-700\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 URL</label>\n                <input type=\"url\" id=\"webhookUrl\" placeholder=\"https://push.wangwangit.com/api/send/your-key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u4ECE <a href=\"https://push.wangwangit.com\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800\">\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u5E73\u53F0</a> \u83B7\u53D6\u7684\u63A8\u9001URL</p>\n              </div>\n              <div>\n                <label for=\"webhookMethod\" class=\"block text-sm font-medium text-gray-700\">\u8BF7\u6C42\u65B9\u6CD5</label>\n                <select id=\"webhookMethod\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                  <option value=\"POST\">POST</option>\n                  <option value=\"GET\">GET</option>\n                  <option value=\"PUT\">PUT</option>\n                </select>\n              </div>\n              <div>\n                <label for=\"webhookHeaders\" class=\"block text-sm font-medium text-gray-700\">\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934 (JSON\u683C\u5F0F\uFF0C\u53EF\u9009)</label>\n                <textarea id=\"webhookHeaders\" rows=\"3\" placeholder='{\"Authorization\": \"Bearer your-token\", \"Content-Type\": \"application/json\"}' class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"></textarea>\n                <p class=\"mt-1 text-sm text-gray-500\">JSON\u683C\u5F0F\u7684\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934\uFF0C\u7559\u7A7A\u4F7F\u7528\u9ED8\u8BA4</p>\n              </div>\n              <div>\n                <label for=\"webhookTemplate\" class=\"block text-sm font-medium text-gray-700\">\u6D88\u606F\u6A21\u677F (JSON\u683C\u5F0F\uFF0C\u53EF\u9009)</label>\n                <textarea id=\"webhookTemplate\" rows=\"4\" placeholder='{\"title\": \"{{title}}\", \"content\": \"{{content}}\", \"timestamp\": \"{{timestamp}}\"}' class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"></textarea>\n                <p class=\"mt-1 text-sm text-gray-500\">\u652F\u6301\u53D8\u91CF: {{title}}, {{content}}, {{timestamp}}\u3002\u7559\u7A7A\u4F7F\u7528\u9ED8\u8BA4\u683C\u5F0F</p>\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testWebhookBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\n              </button>\n            </div>\n          </div>\n\n          <div id=\"wechatbotConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 gap-4 mb-4\">\n              <div>\n                <label for=\"wechatbotWebhook\" class=\"block text-sm font-medium text-gray-700\">\u673A\u5668\u4EBA Webhook URL</label>\n                <input type=\"url\" id=\"wechatbotWebhook\" placeholder=\"https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=your-key\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u4ECE\u4F01\u4E1A\u5FAE\u4FE1\u7FA4\u804A\u4E2D\u6DFB\u52A0\u673A\u5668\u4EBA\u83B7\u53D6\u7684 Webhook URL</p>\n              </div>\n              <div>\n                <label for=\"wechatbotMsgType\" class=\"block text-sm font-medium text-gray-700\">\u6D88\u606F\u7C7B\u578B</label>\n                <select id=\"wechatbotMsgType\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                  <option value=\"text\">\u6587\u672C\u6D88\u606F</option>\n                  <option value=\"markdown\">Markdown\u6D88\u606F</option>\n                </select>\n                <p class=\"mt-1 text-sm text-gray-500\">\u9009\u62E9\u53D1\u9001\u7684\u6D88\u606F\u683C\u5F0F\u7C7B\u578B</p>\n              </div>\n              <div>\n                <label for=\"wechatbotAtMobiles\" class=\"block text-sm font-medium text-gray-700\">@\u624B\u673A\u53F7 (\u53EF\u9009)</label>\n                <input type=\"text\" id=\"wechatbotAtMobiles\" placeholder=\"13800138000,13900139000\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u9700\u8981@\u7684\u624B\u673A\u53F7\uFF0C\u591A\u4E2A\u7528\u9017\u53F7\u5206\u9694\uFF0C\u7559\u7A7A\u5219\u4E0D@\u4EFB\u4F55\u4EBA</p>\n              </div>\n              <div>\n                <label for=\"wechatbotAtAll\" class=\"block text-sm font-medium text-gray-700 mb-2\">@\u6240\u6709\u4EBA</label>\n                <label class=\"inline-flex items-center\">\n                  <input type=\"checkbox\" id=\"wechatbotAtAll\" class=\"form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500\">\n                  <span class=\"ml-2 text-sm text-gray-700\">\u53D1\u9001\u6D88\u606F\u65F6@\u6240\u6709\u4EBA</span>\n                </label>\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testWechatBotBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 \u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\n              </button>\n            </div>\n          </div>\n\n          <div id=\"emailConfig\" class=\"config-section\">\n            <h4 class=\"text-md font-medium text-gray-900 mb-3\">\u90AE\u4EF6\u901A\u77E5 \u914D\u7F6E</h4>\n            <div class=\"grid grid-cols-1 gap-4 mb-4\">\n              <div>\n                <label for=\"resendApiKey\" class=\"block text-sm font-medium text-gray-700\">Resend API Key</label>\n                <input type=\"text\" id=\"resendApiKey\" placeholder=\"re_xxxxxxxxxx\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u4ECE <a href=\"https://resend.com/api-keys\" target=\"_blank\" class=\"text-indigo-600 hover:text-indigo-800\">Resend\u63A7\u5236\u53F0</a> \u83B7\u53D6\u7684 API Key</p>\n              </div>\n              <div>\n                <label for=\"emailFrom\" class=\"block text-sm font-medium text-gray-700\">\u53D1\u4EF6\u4EBA\u90AE\u7BB1</label>\n                <input type=\"email\" id=\"emailFrom\" placeholder=\"noreply@yourdomain.com\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u5FC5\u987B\u662F\u5DF2\u5728Resend\u9A8C\u8BC1\u7684\u57DF\u540D\u90AE\u7BB1</p>\n              </div>\n              <div>\n                <label for=\"emailFromName\" class=\"block text-sm font-medium text-gray-700\">\u53D1\u4EF6\u4EBA\u540D\u79F0</label>\n                <input type=\"text\" id=\"emailFromName\" placeholder=\"\u8BA2\u9605\u63D0\u9192\u7CFB\u7EDF\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u663E\u793A\u5728\u90AE\u4EF6\u4E2D\u7684\u53D1\u4EF6\u4EBA\u540D\u79F0</p>\n              </div>\n              <div>\n                <label for=\"emailTo\" class=\"block text-sm font-medium text-gray-700\">\u6536\u4EF6\u4EBA\u90AE\u7BB1</label>\n                <input type=\"email\" id=\"emailTo\" placeholder=\"user@example.com\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <p class=\"mt-1 text-sm text-gray-500\">\u63A5\u6536\u901A\u77E5\u90AE\u4EF6\u7684\u90AE\u7BB1\u5730\u5740</p>\n              </div>\n            </div>\n            <div class=\"flex justify-end\">\n              <button type=\"button\" id=\"testEmailBtn\" class=\"btn-secondary text-white px-4 py-2 rounded-md text-sm font-medium\">\n                <i class=\"fas fa-paper-plane mr-2\"></i>\u6D4B\u8BD5 \u90AE\u4EF6\u901A\u77E5\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex justify-end\">\n          <button type=\"submit\" class=\"btn-primary text-white px-6 py-2 rounded-md text-sm font-medium\">\n            <i class=\"fas fa-save mr-2\"></i>\u4FDD\u5B58\u914D\u7F6E\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n\n  <script>\n    function showToast(message, type = 'success', duration = 3000) {\n      const container = document.getElementById('toast-container');\n      const toast = document.createElement('div');\n      toast.className = 'toast ' + type;\n      \n      const icon = type === 'success' ? 'check-circle' :\n                   type === 'error' ? 'exclamation-circle' :\n                   type === 'warning' ? 'exclamation-triangle' : 'info-circle';\n      \n      toast.innerHTML = '<div class=\"flex items-center\"><i class=\"fas fa-' + icon + ' mr-2\"></i><span>' + message + '</span></div>';\n      \n      container.appendChild(toast);\n      setTimeout(() => toast.classList.add('show'), 100);\n      setTimeout(() => {\n        toast.classList.remove('show');\n        setTimeout(() => {\n          if (container.contains(toast)) {\n            container.removeChild(toast);\n          }\n        }, 300);\n      }, duration);\n    }\n\n    async function loadConfig() {\n      try {\n        const response = await fetch('/api/config');\n        const config = await response.json();\n\n        document.getElementById('adminUsername').value = config.ADMIN_USERNAME || '';\n        document.getElementById('tgBotToken').value = config.TG_BOT_TOKEN || '';\n        document.getElementById('tgChatId').value = config.TG_CHAT_ID || '';\n        document.getElementById('notifyxApiKey').value = config.NOTIFYX_API_KEY || '';\n        document.getElementById('webhookUrl').value = config.WEBHOOK_URL || '';\n        document.getElementById('webhookMethod').value = config.WEBHOOK_METHOD || 'POST';\n        document.getElementById('webhookHeaders').value = config.WEBHOOK_HEADERS || '';\n        document.getElementById('webhookTemplate').value = config.WEBHOOK_TEMPLATE || '';\n        document.getElementById('wechatbotWebhook').value = config.WECHATBOT_WEBHOOK || '';\n        document.getElementById('wechatbotMsgType').value = config.WECHATBOT_MSG_TYPE || 'text';\n        document.getElementById('wechatbotAtMobiles').value = config.WECHATBOT_AT_MOBILES || '';\n        document.getElementById('wechatbotAtAll').checked = config.WECHATBOT_AT_ALL === 'true';\n        document.getElementById('resendApiKey').value = config.RESEND_API_KEY || '';\n        document.getElementById('emailFrom').value = config.EMAIL_FROM || '';\n        document.getElementById('emailFromName').value = config.EMAIL_FROM_NAME || '\u8BA2\u9605\u63D0\u9192\u7CFB\u7EDF';\n        document.getElementById('emailTo').value = config.EMAIL_TO || '';\n\n        // \u52A0\u8F7D\u519C\u5386\u663E\u793A\u8BBE\u7F6E\n        document.getElementById('showLunarGlobal').checked = config.SHOW_LUNAR === true;\n\n        // \u5904\u7406\u591A\u9009\u901A\u77E5\u6E20\u9053\n        const enabledNotifiers = config.ENABLED_NOTIFIERS || ['notifyx'];\n        document.querySelectorAll('input[name=\"enabledNotifiers\"]').forEach(checkbox => {\n          checkbox.checked = enabledNotifiers.includes(checkbox.value);\n        });\n\n        toggleNotificationConfigs(enabledNotifiers);\n      } catch (error) {\n        console.error('\u52A0\u8F7D\u914D\u7F6E\u5931\u8D25:', error);\n        showToast('\u52A0\u8F7D\u914D\u7F6E\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5', 'error');\n      }\n    }\n    \n    function toggleNotificationConfigs(enabledNotifiers) {\n      const telegramConfig = document.getElementById('telegramConfig');\n      const notifyxConfig = document.getElementById('notifyxConfig');\n      const webhookConfig = document.getElementById('webhookConfig');\n      const wechatbotConfig = document.getElementById('wechatbotConfig');\n      const emailConfig = document.getElementById('emailConfig');\n\n      // \u91CD\u7F6E\u6240\u6709\u914D\u7F6E\u533A\u57DF\n      [telegramConfig, notifyxConfig, webhookConfig, wechatbotConfig, emailConfig].forEach(config => {\n        config.classList.remove('active', 'inactive');\n        config.classList.add('inactive');\n      });\n\n      // \u6FC0\u6D3B\u9009\u4E2D\u7684\u914D\u7F6E\u533A\u57DF\n      enabledNotifiers.forEach(type => {\n        if (type === 'telegram') {\n          telegramConfig.classList.remove('inactive');\n          telegramConfig.classList.add('active');\n        } else if (type === 'notifyx') {\n          notifyxConfig.classList.remove('inactive');\n          notifyxConfig.classList.add('active');\n        } else if (type === 'webhook') {\n          webhookConfig.classList.remove('inactive');\n          webhookConfig.classList.add('active');\n        } else if (type === 'wechatbot') {\n          wechatbotConfig.classList.remove('inactive');\n          wechatbotConfig.classList.add('active');\n        } else if (type === 'email') {\n          emailConfig.classList.remove('inactive');\n          emailConfig.classList.add('active');\n        }\n      });\n    }\n\n    document.querySelectorAll('input[name=\"enabledNotifiers\"]').forEach(checkbox => {\n      checkbox.addEventListener('change', () => {\n        const enabledNotifiers = Array.from(document.querySelectorAll('input[name=\"enabledNotifiers\"]:checked'))\n          .map(cb => cb.value);\n        toggleNotificationConfigs(enabledNotifiers);\n      });\n    });\n    \n    document.getElementById('configForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n\n      const enabledNotifiers = Array.from(document.querySelectorAll('input[name=\"enabledNotifiers\"]:checked'))\n        .map(cb => cb.value);\n\n      if (enabledNotifiers.length === 0) {\n        showToast('\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u79CD\u901A\u77E5\u65B9\u5F0F', 'warning');\n        return;\n      }\n\n      const config = {\n        ADMIN_USERNAME: document.getElementById('adminUsername').value.trim(),\n        TG_BOT_TOKEN: document.getElementById('tgBotToken').value.trim(),\n        TG_CHAT_ID: document.getElementById('tgChatId').value.trim(),\n        NOTIFYX_API_KEY: document.getElementById('notifyxApiKey').value.trim(),\n        WEBHOOK_URL: document.getElementById('webhookUrl').value.trim(),\n        WEBHOOK_METHOD: document.getElementById('webhookMethod').value,\n        WEBHOOK_HEADERS: document.getElementById('webhookHeaders').value.trim(),\n        WEBHOOK_TEMPLATE: document.getElementById('webhookTemplate').value.trim(),\n        SHOW_LUNAR: document.getElementById('showLunarGlobal').checked,\n        WECHATBOT_WEBHOOK: document.getElementById('wechatbotWebhook').value.trim(),\n        WECHATBOT_MSG_TYPE: document.getElementById('wechatbotMsgType').value,\n        WECHATBOT_AT_MOBILES: document.getElementById('wechatbotAtMobiles').value.trim(),\n        WECHATBOT_AT_ALL: document.getElementById('wechatbotAtAll').checked.toString(),\n        RESEND_API_KEY: document.getElementById('resendApiKey').value.trim(),\n        EMAIL_FROM: document.getElementById('emailFrom').value.trim(),\n        EMAIL_FROM_NAME: document.getElementById('emailFromName').value.trim(),\n        EMAIL_TO: document.getElementById('emailTo').value.trim(),\n        ENABLED_NOTIFIERS: enabledNotifiers\n      };\n\n      const passwordField = document.getElementById('adminPassword');\n      if (passwordField.value.trim()) {\n        config.ADMIN_PASSWORD = passwordField.value.trim();\n      }\n\n      const submitButton = e.target.querySelector('button[type=\"submit\"]');\n      const originalContent = submitButton.innerHTML;\n      submitButton.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u4FDD\u5B58\u4E2D...';\n      submitButton.disabled = true;\n\n      try {\n        const response = await fetch('/api/config', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(config)\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          showToast('\u914D\u7F6E\u4FDD\u5B58\u6210\u529F', 'success');\n          passwordField.value = '';\n        } else {\n          showToast('\u914D\u7F6E\u4FDD\u5B58\u5931\u8D25: ' + (result.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n        }\n      } catch (error) {\n        console.error('\u4FDD\u5B58\u914D\u7F6E\u5931\u8D25:', error);\n        showToast('\u4FDD\u5B58\u914D\u7F6E\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n      } finally {\n        submitButton.innerHTML = originalContent;\n        submitButton.disabled = false;\n      }\n    });\n    \n    async function testNotification(type) {\n      const buttonId = type === 'telegram' ? 'testTelegramBtn' :\n                      type === 'notifyx' ? 'testNotifyXBtn' :\n                      type === 'wechatbot' ? 'testWechatBotBtn' :\n                      type === 'email' ? 'testEmailBtn' : 'testWebhookBtn';\n      const button = document.getElementById(buttonId);\n      const originalContent = button.innerHTML;\n      const serviceName = type === 'telegram' ? 'Telegram' :\n                          type === 'notifyx' ? 'NotifyX' :\n                          type === 'wechatbot' ? '\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA' :\n                          type === 'email' ? '\u90AE\u4EF6\u901A\u77E5' : '\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5';\n\n      button.innerHTML = '<i class=\"fas fa-spinner fa-spin mr-2\"></i>\u6D4B\u8BD5\u4E2D...';\n      button.disabled = true;\n\n      const config = {};\n      if (type === 'telegram') {\n        config.TG_BOT_TOKEN = document.getElementById('tgBotToken').value.trim();\n        config.TG_CHAT_ID = document.getElementById('tgChatId').value.trim();\n\n        if (!config.TG_BOT_TOKEN || !config.TG_CHAT_ID) {\n          showToast('\u8BF7\u5148\u586B\u5199 Telegram Bot Token \u548C Chat ID', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'notifyx') {\n        config.NOTIFYX_API_KEY = document.getElementById('notifyxApiKey').value.trim();\n\n        if (!config.NOTIFYX_API_KEY) {\n          showToast('\u8BF7\u5148\u586B\u5199 NotifyX API Key', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'webhook') {\n        config.WEBHOOK_URL = document.getElementById('webhookUrl').value.trim();\n        config.WEBHOOK_METHOD = document.getElementById('webhookMethod').value;\n        config.WEBHOOK_HEADERS = document.getElementById('webhookHeaders').value.trim();\n        config.WEBHOOK_TEMPLATE = document.getElementById('webhookTemplate').value.trim();\n\n        if (!config.WEBHOOK_URL) {\n          showToast('\u8BF7\u5148\u586B\u5199 \u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 URL', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'wechatbot') {\n        config.WECHATBOT_WEBHOOK = document.getElementById('wechatbotWebhook').value.trim();\n        config.WECHATBOT_MSG_TYPE = document.getElementById('wechatbotMsgType').value;\n        config.WECHATBOT_AT_MOBILES = document.getElementById('wechatbotAtMobiles').value.trim();\n        config.WECHATBOT_AT_ALL = document.getElementById('wechatbotAtAll').checked.toString();\n\n        if (!config.WECHATBOT_WEBHOOK) {\n          showToast('\u8BF7\u5148\u586B\u5199\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA Webhook URL', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      } else if (type === 'email') {\n        config.RESEND_API_KEY = document.getElementById('resendApiKey').value.trim();\n        config.EMAIL_FROM = document.getElementById('emailFrom').value.trim();\n        config.EMAIL_FROM_NAME = document.getElementById('emailFromName').value.trim();\n        config.EMAIL_TO = document.getElementById('emailTo').value.trim();\n\n        if (!config.RESEND_API_KEY || !config.EMAIL_FROM || !config.EMAIL_TO) {\n          showToast('\u8BF7\u5148\u586B\u5199 Resend API Key\u3001\u53D1\u4EF6\u4EBA\u90AE\u7BB1\u548C\u6536\u4EF6\u4EBA\u90AE\u7BB1', 'warning');\n          button.innerHTML = originalContent;\n          button.disabled = false;\n          return;\n        }\n      }\n\n      try {\n        const response = await fetch('/api/test-notification', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ type: type, ...config })\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          showToast(serviceName + ' \u901A\u77E5\u6D4B\u8BD5\u6210\u529F\uFF01', 'success');\n        } else {\n          showToast(serviceName + ' \u901A\u77E5\u6D4B\u8BD5\u5931\u8D25: ' + (result.message || '\u672A\u77E5\u9519\u8BEF'), 'error');\n        }\n      } catch (error) {\n        console.error('\u6D4B\u8BD5\u901A\u77E5\u5931\u8D25:', error);\n        showToast('\u6D4B\u8BD5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5', 'error');\n      } finally {\n        button.innerHTML = originalContent;\n        button.disabled = false;\n      }\n    }\n    \n    document.getElementById('testTelegramBtn').addEventListener('click', () => {\n      testNotification('telegram');\n    });\n    \n    document.getElementById('testNotifyXBtn').addEventListener('click', () => {\n      testNotification('notifyx');\n    });\n\n    document.getElementById('testWebhookBtn').addEventListener('click', () => {\n      testNotification('webhook');\n    });\n\n    document.getElementById('testWechatBotBtn').addEventListener('click', () => {\n      testNotification('wechatbot');\n    });\n\n    document.getElementById('testEmailBtn').addEventListener('click', () => {\n      testNotification('email');\n    });\n\n    window.addEventListener('load', loadConfig);\n  </script>\n</body>\n</html>\n`;\n\n// \u7BA1\u7406\u9875\u9762\nconst admin = {\n  async handleRequest(request, env, ctx) {\n    try {\n      const url = new URL(request.url);\n      const pathname = url.pathname;\n\n      console.log('[\u7BA1\u7406\u9875\u9762] \u8BBF\u95EE\u8DEF\u5F84:', pathname);\n\n      const token = getCookieValue(request.headers.get('Cookie'), 'token');\n      console.log('[\u7BA1\u7406\u9875\u9762] Token\u5B58\u5728:', !!token);\n\n      const config = await getConfig(env);\n      const user = token ? await verifyJWT(token, config.JWT_SECRET) : null;\n\n      console.log('[\u7BA1\u7406\u9875\u9762] \u7528\u6237\u9A8C\u8BC1\u7ED3\u679C:', !!user);\n\n      if (!user) {\n        console.log('[\u7BA1\u7406\u9875\u9762] \u7528\u6237\u672A\u767B\u5F55\uFF0C\u91CD\u5B9A\u5411\u5230\u767B\u5F55\u9875\u9762');\n        return new Response('', {\n          status: 302,\n          headers: { 'Location': '/' }\n        });\n      }\n\n      if (pathname === '/admin/config') {\n        return new Response(configPage, {\n          headers: { 'Content-Type': 'text/html; charset=utf-8' }\n        });\n      }\n\n      return new Response(adminPage, {\n        headers: { 'Content-Type': 'text/html; charset=utf-8' }\n      });\n    } catch (error) {\n      console.error('[\u7BA1\u7406\u9875\u9762] \u5904\u7406\u8BF7\u6C42\u65F6\u51FA\u9519:', error);\n      return new Response('\u670D\u52A1\u5668\u5185\u90E8\u9519\u8BEF', {\n        status: 500,\n        headers: { 'Content-Type': 'text/plain; charset=utf-8' }\n      });\n    }\n  }\n};\n\n// \u5904\u7406API\u8BF7\u6C42\nconst api = {\n  async handleRequest(request, env, ctx) {\n    const url = new URL(request.url);\n    const path = url.pathname.slice(4);\n    const method = request.method;\n\n    const config = await getConfig(env);\n\n    if (path === '/login' && method === 'POST') {\n      const body = await request.json();\n\n      if (body.username === config.ADMIN_USERNAME && body.password === config.ADMIN_PASSWORD) {\n        const token = await generateJWT(body.username, config.JWT_SECRET);\n\n        return new Response(\n          JSON.stringify({ success: true }),\n          {\n            headers: {\n              'Content-Type': 'application/json',\n              'Set-Cookie': 'token=' + token + '; HttpOnly; Path=/; SameSite=Strict; Max-Age=86400'\n            }\n          }\n        );\n      } else {\n        return new Response(\n          JSON.stringify({ success: false, message: '\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF' }),\n          { headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n    }\n\n    if (path === '/logout' && (method === 'GET' || method === 'POST')) {\n      return new Response('', {\n        status: 302,\n        headers: {\n          'Location': '/',\n          'Set-Cookie': 'token=; HttpOnly; Path=/; SameSite=Strict; Max-Age=0'\n        }\n      });\n    }\n\n    const token = getCookieValue(request.headers.get('Cookie'), 'token');\n    console.log('[API] Token\u5B58\u5728:', !!token);\n    \n    const user = token ? await verifyJWT(token, config.JWT_SECRET) : null;\n    console.log('[API] \u7528\u6237\u9A8C\u8BC1\u7ED3\u679C:', !!user);\n\n    if (!user && path !== '/login') {\n      console.log('[API] \u672A\u6388\u6743\u8BBF\u95EE\u8DEF\u5F84:', path);\n      return new Response(\n        JSON.stringify({ success: false, message: '\u672A\u6388\u6743\u8BBF\u95EE' }),\n        { status: 401, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n\n    if (path === '/config') {\n      if (method === 'GET') {\n        const { JWT_SECRET, ADMIN_PASSWORD, ...safeConfig } = config;\n        return new Response(\n          JSON.stringify(safeConfig),\n          { headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      if (method === 'POST') {\n        try {\n          const newConfig = await request.json();\n\n          const updatedConfig = {\n            ...config,\n            ADMIN_USERNAME: newConfig.ADMIN_USERNAME || config.ADMIN_USERNAME,\n            TG_BOT_TOKEN: newConfig.TG_BOT_TOKEN || '',\n            TG_CHAT_ID: newConfig.TG_CHAT_ID || '',\n            NOTIFYX_API_KEY: newConfig.NOTIFYX_API_KEY || '',\n            WEBHOOK_URL: newConfig.WEBHOOK_URL || '',\n            WEBHOOK_METHOD: newConfig.WEBHOOK_METHOD || 'POST',\n            WEBHOOK_HEADERS: newConfig.WEBHOOK_HEADERS || '',\n            WEBHOOK_TEMPLATE: newConfig.WEBHOOK_TEMPLATE || '',\n            SHOW_LUNAR: newConfig.SHOW_LUNAR === true,\n            WECHATBOT_WEBHOOK: newConfig.WECHATBOT_WEBHOOK || '',\n            WECHATBOT_MSG_TYPE: newConfig.WECHATBOT_MSG_TYPE || 'text',\n            WECHATBOT_AT_MOBILES: newConfig.WECHATBOT_AT_MOBILES || '',\n            WECHATBOT_AT_ALL: newConfig.WECHATBOT_AT_ALL || 'false',\n            RESEND_API_KEY: newConfig.RESEND_API_KEY || '',\n            EMAIL_FROM: newConfig.EMAIL_FROM || '',\n            EMAIL_FROM_NAME: newConfig.EMAIL_FROM_NAME || '',\n            EMAIL_TO: newConfig.EMAIL_TO || '',\n            ENABLED_NOTIFIERS: newConfig.ENABLED_NOTIFIERS || ['notifyx']\n          };\n\n          if (newConfig.ADMIN_PASSWORD) {\n            updatedConfig.ADMIN_PASSWORD = newConfig.ADMIN_PASSWORD;\n          }\n\n          // \u786E\u4FDDJWT_SECRET\u5B58\u5728\u4E14\u5B89\u5168\n          if (!updatedConfig.JWT_SECRET || updatedConfig.JWT_SECRET === 'your-secret-key') {\n            updatedConfig.JWT_SECRET = generateRandomSecret();\n            console.log('[\u5B89\u5168] \u751F\u6210\u65B0\u7684JWT\u5BC6\u94A5');\n          }\n\n          await env.SUBSCRIPTIONS_KV.put('config', JSON.stringify(updatedConfig));\n\n          return new Response(\n            JSON.stringify({ success: true }),\n            { headers: { 'Content-Type': 'application/json' } }\n          );\n        } catch (error) {\n          console.error('\u914D\u7F6E\u4FDD\u5B58\u9519\u8BEF:', error);\n          return new Response(\n            JSON.stringify({ success: false, message: '\u66F4\u65B0\u914D\u7F6E\u5931\u8D25: ' + error.message }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          );\n        }\n      }\n    }\n\n    if (path === '/test-notification' && method === 'POST') {\n      try {\n        const body = await request.json();\n        let success = false;\n        let message = '';\n\n        if (body.type === 'telegram') {\n          const testConfig = {\n            ...config,\n            TG_BOT_TOKEN: body.TG_BOT_TOKEN,\n            TG_CHAT_ID: body.TG_CHAT_ID\n          };\n\n          const content = '*\u6D4B\u8BD5\u901A\u77E5*\\n\\n\u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5\uFF0C\u7528\u4E8E\u9A8C\u8BC1Telegram\u901A\u77E5\u529F\u80FD\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C\u3002\\n\\n\u53D1\u9001\u65F6\u95F4: ' + formatBeijingTime();\n          success = await sendTelegramNotification(content, testConfig);\n          message = success ? 'Telegram\u901A\u77E5\u53D1\u9001\u6210\u529F' : 'Telegram\u901A\u77E5\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E';\n        } else if (body.type === 'notifyx') {\n          const testConfig = {\n            ...config,\n            NOTIFYX_API_KEY: body.NOTIFYX_API_KEY\n          };\n\n          const title = '\u6D4B\u8BD5\u901A\u77E5';\n          const content = '## \u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5\\n\\n\u7528\u4E8E\u9A8C\u8BC1NotifyX\u901A\u77E5\u529F\u80FD\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C\u3002\\n\\n\u53D1\u9001\u65F6\u95F4: ' + formatBeijingTime();\n          const description = '\u6D4B\u8BD5NotifyX\u901A\u77E5\u529F\u80FD';\n\n          success = await sendNotifyXNotification(title, content, description, testConfig);\n          message = success ? 'NotifyX\u901A\u77E5\u53D1\u9001\u6210\u529F' : 'NotifyX\u901A\u77E5\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E';\n        } else if (body.type === 'webhook') {\n          const testConfig = {\n            ...config,\n            WEBHOOK_URL: body.WEBHOOK_URL,\n            WEBHOOK_METHOD: body.WEBHOOK_METHOD,\n            WEBHOOK_HEADERS: body.WEBHOOK_HEADERS,\n            WEBHOOK_TEMPLATE: body.WEBHOOK_TEMPLATE\n          };\n\n          const title = '\u6D4B\u8BD5\u901A\u77E5';\n          const content = '\u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5\uFF0C\u7528\u4E8E\u9A8C\u8BC1\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u529F\u80FD\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C\u3002\\n\\n\u53D1\u9001\u65F6\u95F4: ' + formatBeijingTime();\n\n          success = await sendWebhookNotification(title, content, testConfig);\n          message = success ? '\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u53D1\u9001\u6210\u529F' : '\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E';\n         } else if (body.type === 'wechatbot') {\n          const testConfig = {\n            ...config,\n            WECHATBOT_WEBHOOK: body.WECHATBOT_WEBHOOK,\n            WECHATBOT_MSG_TYPE: body.WECHATBOT_MSG_TYPE,\n            WECHATBOT_AT_MOBILES: body.WECHATBOT_AT_MOBILES,\n            WECHATBOT_AT_ALL: body.WECHATBOT_AT_ALL\n          };\n\n          const title = '\u6D4B\u8BD5\u901A\u77E5';\n          const content = '\u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5\uFF0C\u7528\u4E8E\u9A8C\u8BC1\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u529F\u80FD\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C\u3002\\n\\n\u53D1\u9001\u65F6\u95F4: ' + formatBeijingTime();\n\n          success = await sendWechatBotNotification(title, content, testConfig);\n          message = success ? '\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u901A\u77E5\u53D1\u9001\u6210\u529F' : '\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u901A\u77E5\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E';\n        } else if (body.type === 'email') {\n          const testConfig = {\n            ...config,\n            RESEND_API_KEY: body.RESEND_API_KEY,\n            EMAIL_FROM: body.EMAIL_FROM,\n            EMAIL_FROM_NAME: body.EMAIL_FROM_NAME,\n            EMAIL_TO: body.EMAIL_TO\n          };\n\n          const title = '\u6D4B\u8BD5\u901A\u77E5';\n          const content = '\u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5\uFF0C\u7528\u4E8E\u9A8C\u8BC1\u90AE\u4EF6\u901A\u77E5\u529F\u80FD\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C\u3002\\n\\n\u53D1\u9001\u65F6\u95F4: ' + formatBeijingTime();\n\n          success = await sendEmailNotification(title, content, testConfig);\n          message = success ? '\u90AE\u4EF6\u901A\u77E5\u53D1\u9001\u6210\u529F' : '\u90AE\u4EF6\u901A\u77E5\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E';\n        }\n\n        return new Response(\n          JSON.stringify({ success, message }),\n          { headers: { 'Content-Type': 'application/json' } }\n        );\n      } catch (error) {\n        console.error('\u6D4B\u8BD5\u901A\u77E5\u5931\u8D25:', error);\n        return new Response(\n          JSON.stringify({ success: false, message: '\u6D4B\u8BD5\u901A\u77E5\u5931\u8D25: ' + error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n    }\n\n    if (path === '/subscriptions') {\n      if (method === 'GET') {\n        try {\n          console.log('[API] \u5F00\u59CB\u83B7\u53D6\u8BA2\u9605\u5217\u8868');\n          const subscriptions = await getAllSubscriptions(env);\n          console.log('[API] \u6210\u529F\u83B7\u53D6\u8BA2\u9605\u5217\u8868\uFF0C\u6570\u91CF:', subscriptions.length);\n          return new Response(\n            JSON.stringify(subscriptions),\n            { headers: { 'Content-Type': 'application/json' } }\n          );\n        } catch (error) {\n          console.error('[API] \u83B7\u53D6\u8BA2\u9605\u5217\u8868\u5931\u8D25:', error);\n          return new Response(\n            JSON.stringify({ \n              success: false, \n              message: '\u83B7\u53D6\u8BA2\u9605\u5217\u8868\u5931\u8D25: ' + error.message,\n              error: error.toString()\n            }),\n            { \n              status: 500,\n              headers: { 'Content-Type': 'application/json' } \n            }\n          );\n        }\n      }\n\n      if (method === 'POST') {\n        const subscription = await request.json();\n        const result = await createSubscription(subscription, env);\n\n        return new Response(\n          JSON.stringify(result),\n          {\n            status: result.success ? 201 : 400,\n            headers: { 'Content-Type': 'application/json' }\n          }\n        );\n      }\n    }\n\n    if (path.startsWith('/subscriptions/')) {\n      const parts = path.split('/');\n      const id = parts[2];\n\n      if (parts[3] === 'toggle-status' && method === 'POST') {\n        const body = await request.json();\n        const result = await toggleSubscriptionStatus(id, body.isActive, env);\n\n        return new Response(\n          JSON.stringify(result),\n          {\n            status: result.success ? 200 : 400,\n            headers: { 'Content-Type': 'application/json' }\n          }\n        );\n      }\n\n      if (parts[3] === 'test-notify' && method === 'POST') {\n        const result = await testSingleSubscriptionNotification(id, env);\n        return new Response(JSON.stringify(result), { status: result.success ? 200 : 500, headers: { 'Content-Type': 'application/json' } });\n      }\n\n      if (method === 'GET') {\n        const subscription = await getSubscription(id, env);\n\n        return new Response(\n          JSON.stringify(subscription),\n          { headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      if (method === 'PUT') {\n        const subscription = await request.json();\n        const result = await updateSubscription(id, subscription, env);\n\n        return new Response(\n          JSON.stringify(result),\n          {\n            status: result.success ? 200 : 400,\n            headers: { 'Content-Type': 'application/json' }\n          }\n        );\n      }\n\n      if (method === 'DELETE') {\n        const result = await deleteSubscription(id, env);\n\n        return new Response(\n          JSON.stringify(result),\n          {\n            status: result.success ? 200 : 400,\n            headers: { 'Content-Type': 'application/json' }\n          }\n        );\n      }\n    }\n\n    // \u5904\u7406\u7B2C\u4E09\u65B9\u901A\u77E5API\n    if (path.startsWith('/notify/')) {\n      const code = path.split('/')[2];\n      if (method === 'POST') {\n        try {\n          const body = await request.json();\n          const title = body.title || '\u7B2C\u4E09\u65B9\u901A\u77E5';\n          const content = body.content || '';\n\n          if (!content) {\n            return new Response(\n              JSON.stringify({ message: '\u7F3A\u5C11\u5FC5\u586B\u53C2\u6570 content' }),\n              { status: 400, headers: { 'Content-Type': 'application/json' } }\n            );\n          }\n\n          const config = await getConfig(env);\n\n          // \u4F7F\u7528\u591A\u6E20\u9053\u53D1\u9001\u901A\u77E5\n          await sendNotificationToAllChannels(title, content, config, '[\u7B2C\u4E09\u65B9API]');\n\n          return new Response(\n            JSON.stringify({\n              message: '\u53D1\u9001\u6210\u529F',\n              response: {\n                errcode: 0,\n                errmsg: 'ok',\n                msgid: 'MSGID' + Date.now()\n              }\n            }),\n            { headers: { 'Content-Type': 'application/json' } }\n          );\n        } catch (error) {\n          console.error('[\u7B2C\u4E09\u65B9API] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n          return new Response(\n            JSON.stringify({\n              message: '\u53D1\u9001\u5931\u8D25',\n              response: {\n                errcode: 1,\n                errmsg: error.message\n              }\n            }),\n            { status: 500, headers: { 'Content-Type': 'application/json' } }\n          );\n        }\n      }\n    }\n\n    return new Response(\n      JSON.stringify({ success: false, message: '\u672A\u627E\u5230\u8BF7\u6C42\u7684\u8D44\u6E90' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    );\n  }\n};\n\n// \u5DE5\u5177\u51FD\u6570\nfunction generateRandomSecret() {\n  // \u751F\u6210\u4E00\u4E2A64\u5B57\u7B26\u7684\u968F\u673A\u5BC6\u94A5\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';\n  let result = '';\n  for (let i = 0; i < 64; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return result;\n}\n\nasync function getConfig(env) {\n  try {\n    if (!env.SUBSCRIPTIONS_KV) {\n      console.error('[\u914D\u7F6E] KV\u5B58\u50A8\u672A\u7ED1\u5B9A');\n      throw new Error('KV\u5B58\u50A8\u672A\u7ED1\u5B9A');\n    }\n\n    const data = await env.SUBSCRIPTIONS_KV.get('config');\n    console.log('[\u914D\u7F6E] \u4ECEKV\u8BFB\u53D6\u914D\u7F6E:', data ? '\u6210\u529F' : '\u7A7A\u914D\u7F6E');\n\n    const config = data ? JSON.parse(data) : {};\n\n    // \u786E\u4FDDJWT_SECRET\u7684\u4E00\u81F4\u6027\n    let jwtSecret = config.JWT_SECRET;\n    if (!jwtSecret || jwtSecret === 'your-secret-key') {\n      jwtSecret = generateRandomSecret();\n      console.log('[\u914D\u7F6E] \u751F\u6210\u65B0\u7684JWT\u5BC6\u94A5');\n\n      // \u4FDD\u5B58\u65B0\u7684JWT\u5BC6\u94A5\n      const updatedConfig = { ...config, JWT_SECRET: jwtSecret };\n      await env.SUBSCRIPTIONS_KV.put('config', JSON.stringify(updatedConfig));\n    }\n\n    const finalConfig = {\n      ADMIN_USERNAME: config.ADMIN_USERNAME || 'admin',\n      ADMIN_PASSWORD: config.ADMIN_PASSWORD || 'password',\n      JWT_SECRET: jwtSecret,\n      TG_BOT_TOKEN: config.TG_BOT_TOKEN || '',\n      TG_CHAT_ID: config.TG_CHAT_ID || '',\n      NOTIFYX_API_KEY: config.NOTIFYX_API_KEY || '',\n      WEBHOOK_URL: config.WEBHOOK_URL || '',\n      WEBHOOK_METHOD: config.WEBHOOK_METHOD || 'POST',\n      WEBHOOK_HEADERS: config.WEBHOOK_HEADERS || '',\n      WEBHOOK_TEMPLATE: config.WEBHOOK_TEMPLATE || '',\n      SHOW_LUNAR: config.SHOW_LUNAR === true,\n      WECHATBOT_WEBHOOK: config.WECHATBOT_WEBHOOK || '',\n      WECHATBOT_MSG_TYPE: config.WECHATBOT_MSG_TYPE || 'text',\n      WECHATBOT_AT_MOBILES: config.WECHATBOT_AT_MOBILES || '',\n      WECHATBOT_AT_ALL: config.WECHATBOT_AT_ALL || 'false',\n      RESEND_API_KEY: config.RESEND_API_KEY || '',\n      EMAIL_FROM: config.EMAIL_FROM || '',\n      EMAIL_FROM_NAME: config.EMAIL_FROM_NAME || '',\n      EMAIL_TO: config.EMAIL_TO || '',\n      ENABLED_NOTIFIERS: config.ENABLED_NOTIFIERS || ['notifyx']\n    };\n\n    console.log('[\u914D\u7F6E] \u6700\u7EC8\u914D\u7F6E\u7528\u6237\u540D:', finalConfig.ADMIN_USERNAME);\n    return finalConfig;\n  } catch (error) {\n    console.error('[\u914D\u7F6E] \u83B7\u53D6\u914D\u7F6E\u5931\u8D25:', error);\n    const defaultJwtSecret = generateRandomSecret();\n\n    return {\n      ADMIN_USERNAME: 'admin',\n      ADMIN_PASSWORD: 'password',\n      JWT_SECRET: defaultJwtSecret,\n      TG_BOT_TOKEN: '',\n      TG_CHAT_ID: '',\n      NOTIFYX_API_KEY: '',\n      WEBHOOK_URL: '',\n      WEBHOOK_METHOD: 'POST',\n      WEBHOOK_HEADERS: '',\n      WEBHOOK_TEMPLATE: '',\n      SHOW_LUNAR: true,\n      WECHATBOT_WEBHOOK: '',\n      WECHATBOT_MSG_TYPE: 'text',\n      WECHATBOT_AT_MOBILES: '',\n      WECHATBOT_AT_ALL: 'false',\n      RESEND_API_KEY: '',\n      EMAIL_FROM: '',\n      EMAIL_FROM_NAME: '',\n      EMAIL_TO: '',\n      ENABLED_NOTIFIERS: ['notifyx']\n    };\n  }\n}\n\nasync function generateJWT(username, secret) {\n  const header = { alg: 'HS256', typ: 'JWT' };\n  const payload = { username, iat: Math.floor(Date.now() / 1000) };\n\n  const headerBase64 = btoa(JSON.stringify(header));\n  const payloadBase64 = btoa(JSON.stringify(payload));\n\n  const signatureInput = headerBase64 + '.' + payloadBase64;\n  const signature = await CryptoJS.HmacSHA256(signatureInput, secret);\n\n  return headerBase64 + '.' + payloadBase64 + '.' + signature;\n}\n\nasync function verifyJWT(token, secret) {\n  try {\n    if (!token || !secret) {\n      console.log('[JWT] Token\u6216Secret\u4E3A\u7A7A');\n      return null;\n    }\n\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n      console.log('[JWT] Token\u683C\u5F0F\u9519\u8BEF\uFF0C\u90E8\u5206\u6570\u91CF:', parts.length);\n      return null;\n    }\n\n    const [headerBase64, payloadBase64, signature] = parts;\n    const signatureInput = headerBase64 + '.' + payloadBase64;\n    const expectedSignature = await CryptoJS.HmacSHA256(signatureInput, secret);\n\n    if (signature !== expectedSignature) {\n      console.log('[JWT] \u7B7E\u540D\u9A8C\u8BC1\u5931\u8D25');\n      return null;\n    }\n\n    const payload = JSON.parse(atob(payloadBase64));\n    console.log('[JWT] \u9A8C\u8BC1\u6210\u529F\uFF0C\u7528\u6237:', payload.username);\n    return payload;\n  } catch (error) {\n    console.error('[JWT] \u9A8C\u8BC1\u8FC7\u7A0B\u51FA\u9519:', error);\n    return null;\n  }\n}\n\nasync function getAllSubscriptions(env) {\n  try {\n    console.log('[getAllSubscriptions] \u5F00\u59CB\u83B7\u53D6\u8BA2\u9605\u6570\u636E');\n    \n    if (!env.SUBSCRIPTIONS_KV) {\n      console.error('[getAllSubscriptions] KV\u5B58\u50A8\u672A\u7ED1\u5B9A');\n      throw new Error('KV\u5B58\u50A8\u672A\u7ED1\u5B9A');\n    }\n    \n    const data = await env.SUBSCRIPTIONS_KV.get('subscriptions');\n    console.log('[getAllSubscriptions] KV\u8FD4\u56DE\u6570\u636E:', data ? `\u6709\u6570\u636E (\u957F\u5EA6: ${data.length})` : '\u65E0\u6570\u636E');\n    \n    const subscriptions = data ? JSON.parse(data) : [];\n    console.log('[getAllSubscriptions] \u89E3\u6790\u540E\u7684\u8BA2\u9605\u6570\u91CF:', subscriptions.length);\n    \n    return subscriptions;\n  } catch (error) {\n    console.error('[getAllSubscriptions] \u83B7\u53D6\u8BA2\u9605\u6570\u636E\u5931\u8D25:', error);\n    throw error; // \u91CD\u65B0\u629B\u51FA\u9519\u8BEF\u800C\u4E0D\u662F\u9759\u9ED8\u8FD4\u56DE\u7A7A\u6570\u7EC4\n  }\n}\n\nasync function getSubscription(id, env) {\n  const subscriptions = await getAllSubscriptions(env);\n  return subscriptions.find(s => s.id === id);\n}\n\n// 2. \u4FEE\u6539 createSubscription\uFF0C\u652F\u6301 useLunar \u5B57\u6BB5\nasync function createSubscription(subscription, env) {\n  try {\n    const subscriptions = await getAllSubscriptions(env);\n\n    if (!subscription.name || !subscription.expiryDate) {\n      return { success: false, message: '\u7F3A\u5C11\u5FC5\u586B\u5B57\u6BB5' };\n    }\n\n    let expiryDate = new Date(subscription.expiryDate);\n    const now = new Date();\n    \n\n    let useLunar = !!subscription.useLunar;\n    if (useLunar) {\n      let lunar = lunarCalendar.solar2lunar(\n        expiryDate.getFullYear(),\n        expiryDate.getMonth() + 1,\n        expiryDate.getDate()\n      );\n      \n      if (lunar && subscription.periodValue && subscription.periodUnit) {\n        // \u5982\u679C\u5230\u671F\u65E5<=\u4ECA\u5929\uFF0C\u81EA\u52A8\u63A8\u7B97\u5230\u4E0B\u4E00\u4E2A\u5468\u671F\n        while (expiryDate <= now) {\n          lunar = lunarBiz.addLunarPeriod(lunar, subscription.periodValue, subscription.periodUnit);\n          const solar = lunarBiz.lunar2solar(lunar);\n          expiryDate = new Date(solar.year, solar.month - 1, solar.day);\n        }\n        subscription.expiryDate = expiryDate.toISOString();\n      }\n    } else {\n      if (expiryDate < now && subscription.periodValue && subscription.periodUnit) {\n        while (expiryDate < now) {\n          if (subscription.periodUnit === 'day') {\n            expiryDate.setDate(expiryDate.getDate() + subscription.periodValue);\n          } else if (subscription.periodUnit === 'month') {\n            expiryDate.setMonth(expiryDate.getMonth() + subscription.periodValue);\n          } else if (subscription.periodUnit === 'year') {\n            expiryDate.setFullYear(expiryDate.getFullYear() + subscription.periodValue);\n          }\n        }\n        subscription.expiryDate = expiryDate.toISOString();\n      }\n    }\n\n    const newSubscription = {\n      id: Date.now().toString(),\n      name: subscription.name,\n      customType: subscription.customType || '',\n      startDate: subscription.startDate || null,\n      expiryDate: subscription.expiryDate,\n      periodValue: subscription.periodValue || 1,\n      periodUnit: subscription.periodUnit || 'month',\n      reminderDays: subscription.reminderDays !== undefined ? subscription.reminderDays : 7,\n      notes: subscription.notes || '',\n      amount: subscription.amount || null, // \u65B0\u589E\uFF1A\u91D1\u989D\u5B57\u6BB5\n      currency: subscription.currency || 'NTD', // \u65B0\u589E\uFF1A\u8D27\u5E01\u5B57\u6BB5\uFF0C\u9ED8\u8BA4\u53F0\u5E01\n      isActive: subscription.isActive !== false,\n      autoRenew: subscription.autoRenew !== false,\n      useLunar: useLunar, // \u65B0\u589E\n      createdAt: new Date().toISOString()\n    };\n\n    subscriptions.push(newSubscription);\n\n    await env.SUBSCRIPTIONS_KV.put('subscriptions', JSON.stringify(subscriptions));\n\n    return { success: true, subscription: newSubscription };\n  } catch (error) {\n    console.error(\"\u521B\u5EFA\u8BA2\u9605\u5F02\u5E38\uFF1A\", error && error.stack ? error.stack : error);\n    return { success: false, message: error && error.message ? error.message : '\u521B\u5EFA\u8BA2\u9605\u5931\u8D25' };\n  }\n}\n\n// 3. \u4FEE\u6539 updateSubscription\uFF0C\u652F\u6301 useLunar \u5B57\u6BB5\nasync function updateSubscription(id, subscription, env) {\n  try {\n    const subscriptions = await getAllSubscriptions(env);\n    const index = subscriptions.findIndex(s => s.id === id);\n\n    if (index === -1) {\n      return { success: false, message: '\u8BA2\u9605\u4E0D\u5B58\u5728' };\n    }\n\n    if (!subscription.name || !subscription.expiryDate) {\n      return { success: false, message: '\u7F3A\u5C11\u5FC5\u586B\u5B57\u6BB5' };\n    }\n\n    let expiryDate = new Date(subscription.expiryDate);\n    const now = new Date();\n\nlet useLunar = !!subscription.useLunar;\nif (useLunar) {\n  let lunar = lunarCalendar.solar2lunar(\n    expiryDate.getFullYear(),\n    expiryDate.getMonth() + 1,\n    expiryDate.getDate()\n  );\n  if (!lunar) {\n    return { success: false, message: '\u519C\u5386\u65E5\u671F\u8D85\u51FA\u652F\u6301\u8303\u56F4\uFF081900-2100\u5E74\uFF09' };\n  }\n  if (lunar && expiryDate < now && subscription.periodValue && subscription.periodUnit) {\n    // \u65B0\u589E\uFF1A\u5FAA\u73AF\u52A0\u5468\u671F\uFF0C\u76F4\u5230 expiryDate > now\n    do {\n      lunar = lunarBiz.addLunarPeriod(lunar, subscription.periodValue, subscription.periodUnit);\n      const solar = lunarBiz.lunar2solar(lunar);\n      expiryDate = new Date(solar.year, solar.month - 1, solar.day);\n    } while (expiryDate < now);\n    subscription.expiryDate = expiryDate.toISOString();\n  }\n} else {\n      if (expiryDate < now && subscription.periodValue && subscription.periodUnit) {\n        while (expiryDate < now) {\n          if (subscription.periodUnit === 'day') {\n            expiryDate.setDate(expiryDate.getDate() + subscription.periodValue);\n          } else if (subscription.periodUnit === 'month') {\n            expiryDate.setMonth(expiryDate.getMonth() + subscription.periodValue);\n          } else if (subscription.periodUnit === 'year') {\n            expiryDate.setFullYear(expiryDate.getFullYear() + subscription.periodValue);\n          }\n        }\n        subscription.expiryDate = expiryDate.toISOString();\n      }\n    }\n\n    subscriptions[index] = {\n      ...subscriptions[index],\n      name: subscription.name,\n      customType: subscription.customType || subscriptions[index].customType || '',\n      startDate: subscription.startDate || subscriptions[index].startDate,\n      expiryDate: subscription.expiryDate,\n      periodValue: subscription.periodValue || subscriptions[index].periodValue || 1,\n      periodUnit: subscription.periodUnit || subscriptions[index].periodUnit || 'month',\n      reminderDays: subscription.reminderDays !== undefined ? subscription.reminderDays : (subscriptions[index].reminderDays !== undefined ? subscriptions[index].reminderDays : 7),\n      notes: subscription.notes || '',\n      amount: subscription.amount !== undefined ? subscription.amount : subscriptions[index].amount, // \u65B0\u589E\uFF1A\u91D1\u989D\u5B57\u6BB5\n      currency: subscription.currency || subscriptions[index].currency || 'NTD', // \u65B0\u589E\uFF1A\u8D27\u5E01\u5B57\u6BB5\uFF0C\u9ED8\u8BA4\u53F0\u5E01\n      isActive: subscription.isActive !== undefined ? subscription.isActive : subscriptions[index].isActive,\n      autoRenew: subscription.autoRenew !== undefined ? subscription.autoRenew : (subscriptions[index].autoRenew !== undefined ? subscriptions[index].autoRenew : true),\n      useLunar: useLunar, // \u65B0\u589E\n      updatedAt: new Date().toISOString()\n    };\n\n    await env.SUBSCRIPTIONS_KV.put('subscriptions', JSON.stringify(subscriptions));\n\n    return { success: true, subscription: subscriptions[index] };\n  } catch (error) {\n    return { success: false, message: '\u66F4\u65B0\u8BA2\u9605\u5931\u8D25' };\n  }\n}\n\nasync function deleteSubscription(id, env) {\n  try {\n    const subscriptions = await getAllSubscriptions(env);\n    const filteredSubscriptions = subscriptions.filter(s => s.id !== id);\n\n    if (filteredSubscriptions.length === subscriptions.length) {\n      return { success: false, message: '\u8BA2\u9605\u4E0D\u5B58\u5728' };\n    }\n\n    await env.SUBSCRIPTIONS_KV.put('subscriptions', JSON.stringify(filteredSubscriptions));\n\n    return { success: true };\n  } catch (error) {\n    return { success: false, message: '\u5220\u9664\u8BA2\u9605\u5931\u8D25' };\n  }\n}\n\nasync function toggleSubscriptionStatus(id, isActive, env) {\n  try {\n    const subscriptions = await getAllSubscriptions(env);\n    const index = subscriptions.findIndex(s => s.id === id);\n\n    if (index === -1) {\n      return { success: false, message: '\u8BA2\u9605\u4E0D\u5B58\u5728' };\n    }\n\n    subscriptions[index] = {\n      ...subscriptions[index],\n      isActive: isActive,\n      updatedAt: new Date().toISOString()\n    };\n\n    await env.SUBSCRIPTIONS_KV.put('subscriptions', JSON.stringify(subscriptions));\n\n    return { success: true, subscription: subscriptions[index] };\n  } catch (error) {\n    return { success: false, message: '\u66F4\u65B0\u8BA2\u9605\u72B6\u6001\u5931\u8D25' };\n  }\n}\n\nasync function testSingleSubscriptionNotification(id, env) {\n  try {\n    const subscription = await getSubscription(id, env);\n    if (!subscription) {\n      return { success: false, message: '\u672A\u627E\u5230\u8BE5\u8BA2\u9605' };\n    }\n    const config = await getConfig(env);\n\n    const title = `\u624B\u52A8\u6D4B\u8BD5\u901A\u77E5: ${subscription.name}`;\n\n    // \u68C0\u67E5\u662F\u5426\u663E\u793A\u519C\u5386\uFF08\u4ECE\u914D\u7F6E\u4E2D\u83B7\u53D6\uFF0C\u9ED8\u8BA4\u4E0D\u663E\u793A\uFF09\n    const showLunar = config.SHOW_LUNAR === true;\n    let lunarExpiryText = '';\n\n    if (showLunar) {\n      // \u8BA1\u7B97\u519C\u5386\u65E5\u671F\n      const expiryDateObj = new Date(subscription.expiryDate);\n      const lunarExpiry = lunarCalendar.solar2lunar(expiryDateObj.getFullYear(), expiryDateObj.getMonth() + 1, expiryDateObj.getDate());\n      lunarExpiryText = lunarExpiry ? ` (\u519C\u5386: ${lunarExpiry.fullStr})` : '';\n    }\n\n    const commonContent = `**\u8BA2\u9605\u8BE6\u60C5**:\\n- **\u7C7B\u578B**: ${subscription.customType || '\u5176\u4ED6'}\\n- **\u5230\u671F\u65E5**: ${formatBeijingTime(new Date(subscription.expiryDate), 'date')}${lunarExpiryText}\\n- **\u5907\u6CE8**: ${subscription.notes || '\u65E0'}`;\n\n    // \u4F7F\u7528\u591A\u6E20\u9053\u53D1\u9001\n    await sendNotificationToAllChannels(title, commonContent, config, '[\u624B\u52A8\u6D4B\u8BD5]');\n\n    return { success: true, message: '\u6D4B\u8BD5\u901A\u77E5\u5DF2\u53D1\u9001\u5230\u6240\u6709\u542F\u7528\u7684\u6E20\u9053' };\n\n  } catch (error) {\n    console.error('[\u624B\u52A8\u6D4B\u8BD5] \u53D1\u9001\u5931\u8D25:', error);\n    return { success: false, message: '\u53D1\u9001\u65F6\u53D1\u751F\u9519\u8BEF: ' + error.message };\n  }\n}\n\nasync function sendWebhookNotification(title, content, config) {\n  try {\n    if (!config.WEBHOOK_URL) {\n      console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11URL');\n      return false;\n    }\n\n    console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u5F00\u59CB\u53D1\u9001\u901A\u77E5\u5230: ' + config.WEBHOOK_URL);\n\n    const timestamp = formatBeijingTime(new Date(), 'datetime');\n    let requestBody;\n    let headers = { 'Content-Type': 'application/json' };\n\n    // \u5904\u7406\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934\n    if (config.WEBHOOK_HEADERS) {\n      try {\n        const customHeaders = JSON.parse(config.WEBHOOK_HEADERS);\n        headers = { ...headers, ...customHeaders };\n      } catch (error) {\n        console.warn('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934\u683C\u5F0F\u9519\u8BEF\uFF0C\u4F7F\u7528\u9ED8\u8BA4\u8BF7\u6C42\u5934');\n      }\n    }\n\n    // \u5904\u7406\u6D88\u606F\u6A21\u677F\n    if (config.WEBHOOK_TEMPLATE) {\n      try {\n        const template = JSON.parse(config.WEBHOOK_TEMPLATE);\n        requestBody = JSON.stringify(template)\n          .replace(/\\{\\{title\\}\\}/g, title)\n          .replace(/\\{\\{content\\}\\}/g, content)\n          .replace(/\\{\\{timestamp\\}\\}/g, timestamp);\n        requestBody = JSON.parse(requestBody);\n      } catch (error) {\n        console.warn('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u6D88\u606F\u6A21\u677F\u683C\u5F0F\u9519\u8BEF\uFF0C\u4F7F\u7528\u9ED8\u8BA4\u683C\u5F0F');\n        requestBody = { title, content, timestamp };\n      }\n    } else {\n      requestBody = { title, content, timestamp };\n    }\n\n    const response = await fetch(config.WEBHOOK_URL, {\n      method: config.WEBHOOK_METHOD || 'POST',\n      headers: headers,\n      body: JSON.stringify(requestBody)\n    });\n\n    const result = await response.text();\n    console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u53D1\u9001\u7ED3\u679C:', response.status, result);\n    return response.ok;\n  } catch (error) {\n    console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\nasync function sendWeComNotification(message, config) {\n    // This is a placeholder. In a real scenario, you would implement the WeCom notification logic here.\n    console.log(\"[\u4F01\u4E1A\u5FAE\u4FE1] \u901A\u77E5\u529F\u80FD\u672A\u5B9E\u73B0\");\n    return { success: false, message: \"\u4F01\u4E1A\u5FAE\u4FE1\u901A\u77E5\u529F\u80FD\u672A\u5B9E\u73B0\" };\n}\n\nasync function sendWechatBotNotification(title, content, config) {\n  try {\n    if (!config.WECHATBOT_WEBHOOK) {\n      console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11Webhook URL');\n      return false;\n    }\n\n    console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u5F00\u59CB\u53D1\u9001\u901A\u77E5\u5230: ' + config.WECHATBOT_WEBHOOK);\n\n    // \u6784\u5EFA\u6D88\u606F\u5185\u5BB9\n    let messageData;\n    const msgType = config.WECHATBOT_MSG_TYPE || 'text';\n\n    if (msgType === 'markdown') {\n      // Markdown \u6D88\u606F\u683C\u5F0F\n      const markdownContent = `# ${title}\\n\\n${content}`;\n      messageData = {\n        msgtype: 'markdown',\n        markdown: {\n          content: markdownContent\n        }\n      };\n    } else {\n      // \u6587\u672C\u6D88\u606F\u683C\u5F0F\n      const textContent = `${title}\\n\\n${content}`;\n      messageData = {\n        msgtype: 'text',\n        text: {\n          content: textContent\n        }\n      };\n    }\n\n    // \u5904\u7406@\u529F\u80FD\n    if (config.WECHATBOT_AT_ALL === 'true') {\n      // @\u6240\u6709\u4EBA\n      if (msgType === 'text') {\n        messageData.text.mentioned_list = ['@all'];\n      }\n    } else if (config.WECHATBOT_AT_MOBILES) {\n      // @\u6307\u5B9A\u624B\u673A\u53F7\n      const mobiles = config.WECHATBOT_AT_MOBILES.split(',').map(m => m.trim()).filter(m => m);\n      if (mobiles.length > 0) {\n        if (msgType === 'text') {\n          messageData.text.mentioned_mobile_list = mobiles;\n        }\n      }\n    }\n\n    console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u53D1\u9001\u6D88\u606F\u6570\u636E:', JSON.stringify(messageData, null, 2));\n\n    const response = await fetch(config.WECHATBOT_WEBHOOK, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(messageData)\n    });\n\n    const responseText = await response.text();\n    console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u54CD\u5E94\u72B6\u6001:', response.status);\n    console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u54CD\u5E94\u5185\u5BB9:', responseText);\n\n    if (response.ok) {\n      try {\n        const result = JSON.parse(responseText);\n        if (result.errcode === 0) {\n          console.log('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u901A\u77E5\u53D1\u9001\u6210\u529F');\n          return true;\n        } else {\n          console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u53D1\u9001\u5931\u8D25\uFF0C\u9519\u8BEF\u7801:', result.errcode, '\u9519\u8BEF\u4FE1\u606F:', result.errmsg);\n          return false;\n        }\n      } catch (parseError) {\n        console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u89E3\u6790\u54CD\u5E94\u5931\u8D25:', parseError);\n        return false;\n      }\n    } else {\n      console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] HTTP\u8BF7\u6C42\u5931\u8D25\uFF0C\u72B6\u6001\u7801:', response.status);\n      return false;\n    }\n  } catch (error) {\n    console.error('[\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\nasync function sendNotificationToAllChannels(title, commonContent, config, logPrefix = '[\u5B9A\u65F6\u4EFB\u52A1]') {\n    if (!config.ENABLED_NOTIFIERS || config.ENABLED_NOTIFIERS.length === 0) {\n        console.log(`${logPrefix} \u672A\u542F\u7528\u4EFB\u4F55\u901A\u77E5\u6E20\u9053\u3002`);\n        return;\n    }\n\n    if (config.ENABLED_NOTIFIERS.includes('notifyx')) {\n        const notifyxContent = `## ${title}\\n\\n${commonContent}`;\n        const success = await sendNotifyXNotification(title, notifyxContent, `\u8BA2\u9605\u63D0\u9192`, config);\n        console.log(`${logPrefix} \u53D1\u9001NotifyX\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.ENABLED_NOTIFIERS.includes('telegram')) {\n        const telegramContent = `*${title}*\\n\\n${commonContent.replace(/(\\s)/g, ' ')}`;\n        const success = await sendTelegramNotification(telegramContent, config);\n        console.log(`${logPrefix} \u53D1\u9001Telegram\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.ENABLED_NOTIFIERS.includes('webhook')) {\n        const webhookContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendWebhookNotification(title, webhookContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u4F01\u4E1A\u5FAE\u4FE1\u5E94\u7528\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.ENABLED_NOTIFIERS.includes('wechatbot')) {\n        const wechatbotContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendWechatBotNotification(title, wechatbotContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u4F01\u4E1A\u5FAE\u4FE1\u673A\u5668\u4EBA\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n    if (config.ENABLED_NOTIFIERS.includes('weixin')) {\n        const weixinContent = `\u3010${title}\u3011\\n\\n${commonContent.replace(/(\\**|\\*|##|#|`)/g, '')}`;\n        const result = await sendWeComNotification(weixinContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u4F01\u4E1A\u5FAE\u4FE1\u901A\u77E5 ${result.success ? '\u6210\u529F' : '\u5931\u8D25'}. ${result.message}`);\n    }\n    if (config.ENABLED_NOTIFIERS.includes('email')) {\n        const emailContent = commonContent.replace(/(\\**|\\*|##|#|`)/g, '');\n        const success = await sendEmailNotification(title, emailContent, config);\n        console.log(`${logPrefix} \u53D1\u9001\u90AE\u4EF6\u901A\u77E5 ${success ? '\u6210\u529F' : '\u5931\u8D25'}`);\n    }\n}\n\nasync function sendTelegramNotification(message, config) {\n  try {\n    if (!config.TG_BOT_TOKEN || !config.TG_CHAT_ID) {\n      console.error('[Telegram] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11Bot Token\u6216Chat ID');\n      return false;\n    }\n\n    console.log('[Telegram] \u5F00\u59CB\u53D1\u9001\u901A\u77E5\u5230 Chat ID: ' + config.TG_CHAT_ID);\n\n    const url = 'https://api.telegram.org/bot' + config.TG_BOT_TOKEN + '/sendMessage';\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        chat_id: config.TG_CHAT_ID,\n        text: message,\n        parse_mode: 'Markdown'\n      })\n    });\n\n    const result = await response.json();\n    console.log('[Telegram] \u53D1\u9001\u7ED3\u679C:', result);\n    return result.ok;\n  } catch (error) {\n    console.error('[Telegram] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\nasync function sendNotifyXNotification(title, content, description, config) {\n  try {\n    if (!config.NOTIFYX_API_KEY) {\n      console.error('[NotifyX] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11API Key');\n      return false;\n    }\n\n    console.log('[NotifyX] \u5F00\u59CB\u53D1\u9001\u901A\u77E5: ' + title);\n\n    const url = 'https://www.notifyx.cn/api/v1/send/' + config.NOTIFYX_API_KEY;\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        title: title,\n        content: content,\n        description: description || ''\n      })\n    });\n\n    const result = await response.json();\n    console.log('[NotifyX] \u53D1\u9001\u7ED3\u679C:', result);\n    return result.status === 'queued';\n  } catch (error) {\n    console.error('[NotifyX] \u53D1\u9001\u901A\u77E5\u5931\u8D25:', error);\n    return false;\n  }\n}\n\nasync function sendEmailNotification(title, content, config) {\n  try {\n    if (!config.RESEND_API_KEY || !config.EMAIL_FROM || !config.EMAIL_TO) {\n      console.error('[\u90AE\u4EF6\u901A\u77E5] \u901A\u77E5\u672A\u914D\u7F6E\uFF0C\u7F3A\u5C11\u5FC5\u8981\u53C2\u6570');\n      return false;\n    }\n\n    console.log('[\u90AE\u4EF6\u901A\u77E5] \u5F00\u59CB\u53D1\u9001\u90AE\u4EF6\u5230: ' + config.EMAIL_TO);\n\n    // \u751F\u6210HTML\u90AE\u4EF6\u5185\u5BB9\n    const htmlContent = `\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>${title}</title>\n    <style>\n        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; background-color: #f5f5f5; }\n        .container { max-width: 600px; margin: 0 auto; background-color: #ffffff; }\n        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px 20px; text-align: center; }\n        .header h1 { color: white; margin: 0; font-size: 24px; }\n        .content { padding: 30px 20px; }\n        .content h2 { color: #333; margin-top: 0; }\n        .content p { color: #666; line-height: 1.6; margin: 16px 0; }\n        .footer { background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 14px; }\n        .highlight { background-color: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0; }\n        .button { display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; margin: 20px 0; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>\uD83D\uDCC5 ${title}</h1>\n        </div>\n        <div class=\"content\">\n            <div class=\"highlight\">\n                ${content.replace(/\\n/g, '<br>')}\n            </div>\n            <p>\u6B64\u90AE\u4EF6\u7531\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF\u81EA\u52A8\u53D1\u9001\uFF0C\u8BF7\u53CA\u65F6\u5904\u7406\u76F8\u5173\u8BA2\u9605\u4E8B\u52A1\u3002</p>\n        </div>\n        <div class=\"footer\">\n            <p>\u8BA2\u9605\u7BA1\u7406\u7CFB\u7EDF | \u53D1\u9001\u65F6\u95F4: ${formatBeijingTime()}</p>\n        </div>\n    </div>\n</body>\n</html>`;\n\n    const fromEmail = config.EMAIL_FROM_NAME ?\n      `${config.EMAIL_FROM_NAME} <${config.EMAIL_FROM}>` :\n      config.EMAIL_FROM;\n\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${config.RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: fromEmail,\n        to: config.EMAIL_TO,\n        subject: title,\n        html: htmlContent,\n        text: content // \u7EAF\u6587\u672C\u5907\u7528\n      })\n    });\n\n    const result = await response.json();\n    console.log('[\u90AE\u4EF6\u901A\u77E5] \u53D1\u9001\u7ED3\u679C:', response.status, result);\n\n    if (response.ok && result.id) {\n      console.log('[\u90AE\u4EF6\u901A\u77E5] \u90AE\u4EF6\u53D1\u9001\u6210\u529F\uFF0CID:', result.id);\n      return true;\n    } else {\n      console.error('[\u90AE\u4EF6\u901A\u77E5] \u90AE\u4EF6\u53D1\u9001\u5931\u8D25:', result);\n      return false;\n    }\n  } catch (error) {\n    console.error('[\u90AE\u4EF6\u901A\u77E5] \u53D1\u9001\u90AE\u4EF6\u5931\u8D25:', error);\n    return false;\n  }\n}\n\nasync function sendNotification(title, content, description, config) {\n  if (config.NOTIFICATION_TYPE === 'notifyx') {\n    return await sendNotifyXNotification(title, content, description, config);\n  } else {\n    return await sendTelegramNotification(content, config);\n  }\n}\n\n// 4. \u4FEE\u6539\u5B9A\u65F6\u4EFB\u52A1 checkExpiringSubscriptions\uFF0C\u652F\u6301\u519C\u5386\u5468\u671F\u81EA\u52A8\u7EED\u8BA2\u548C\u519C\u5386\u63D0\u9192\nasync function checkExpiringSubscriptions(env) {\n  try {\n    const now = new Date();\n    const beijingTime = new Date(now.getTime() + 8 * 60 * 60 * 1000);\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u5F00\u59CB\u68C0\u67E5\u5373\u5C06\u5230\u671F\u7684\u8BA2\u9605 UTC: ' + now.toISOString() + ', \u5317\u4EAC\u65F6\u95F4: ' + beijingTime.toLocaleString('zh-CN', {timeZone: 'Asia/Shanghai'}));\n\n    const subscriptions = await getAllSubscriptions(env);\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u5171\u627E\u5230 ' + subscriptions.length + ' \u4E2A\u8BA2\u9605');\n\n    const config = await getConfig(env);\n    const expiringSubscriptions = [];\n    const updatedSubscriptions = [];\n    let hasUpdates = false;\n\nfor (const subscription of subscriptions) {\n  if (subscription.isActive === false) {\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5DF2\u505C\u7528\uFF0C\u8DF3\u8FC7');\n    continue;\n  }\n\n  let daysDiff;\n  if (subscription.useLunar) {\n    const expiryDate = new Date(subscription.expiryDate);\n    let lunar = lunarCalendar.solar2lunar(\n      expiryDate.getFullYear(),\n      expiryDate.getMonth() + 1,\n      expiryDate.getDate()\n    );\n    daysDiff = lunarBiz.daysToLunar(lunar);\n\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5230\u671F\u65E5\u671F: ' + expiryDate.toISOString() + ', \u5269\u4F59\u5929\u6570: ' + daysDiff);\n\n    if (daysDiff < 0 && subscription.periodValue && subscription.periodUnit && subscription.autoRenew !== false) {\n      let nextLunar = lunar;\n      do {\n        nextLunar = lunarBiz.addLunarPeriod(nextLunar, subscription.periodValue, subscription.periodUnit);\n        const solar = lunarBiz.lunar2solar(nextLunar);\n        var newExpiryDate = new Date(solar.year, solar.month - 1, solar.day);\n        daysDiff = lunarBiz.daysToLunar(nextLunar);\n        console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u66F4\u65B0\u5230\u671F\u65E5\u671F: ' + newExpiryDate.toISOString() + ', \u5269\u4F59\u5929\u6570: ' + daysDiff);\n      } while (daysDiff < 0);\n\n      const updatedSubscription = { ...subscription, expiryDate: newExpiryDate.toISOString() };\n      updatedSubscriptions.push(updatedSubscription);\n      hasUpdates = true;\n\n      let reminderDays = subscription.reminderDays !== undefined ? subscription.reminderDays : 7;\n      let shouldRemindAfterRenewal = false;\n      if (reminderDays === 0) {\n        shouldRemindAfterRenewal = daysDiff === 0;\n      } else {\n        shouldRemindAfterRenewal = daysDiff >= 0 && daysDiff <= reminderDays;\n      }\n      if (shouldRemindAfterRenewal) {\n        console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5728\u63D0\u9192\u8303\u56F4\u5185\uFF0C\u5C06\u53D1\u9001\u901A\u77E5');\n        expiringSubscriptions.push({\n          ...updatedSubscription,\n          daysRemaining: daysDiff\n        });\n      }\n      continue;\n    }\n  } else {\n    const expiryDate = new Date(subscription.expiryDate);\n    daysDiff = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));\n\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5230\u671F\u65E5\u671F: ' + expiryDate.toISOString() + ', \u5269\u4F59\u5929\u6570: ' + daysDiff);\n\n    if (daysDiff < 0 && subscription.periodValue && subscription.periodUnit && subscription.autoRenew !== false) {\n      const newExpiryDate = new Date(expiryDate);\n\n      if (subscription.periodUnit === 'day') {\n        newExpiryDate.setDate(expiryDate.getDate() + subscription.periodValue);\n      } else if (subscription.periodUnit === 'month') {\n        newExpiryDate.setMonth(expiryDate.getMonth() + subscription.periodValue);\n      } else if (subscription.periodUnit === 'year') {\n        newExpiryDate.setFullYear(expiryDate.getFullYear() + subscription.periodValue);\n      }\n\n      while (newExpiryDate < now) {\n        console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u65B0\u8BA1\u7B97\u7684\u5230\u671F\u65E5\u671F ' + newExpiryDate.toISOString() + ' \u4ECD\u7136\u8FC7\u671F\uFF0C\u7EE7\u7EED\u8BA1\u7B97\u4E0B\u4E00\u4E2A\u5468\u671F');\n        if (subscription.periodUnit === 'day') {\n          newExpiryDate.setDate(newExpiryDate.getDate() + subscription.periodValue);\n        } else if (subscription.periodUnit === 'month') {\n          newExpiryDate.setMonth(newExpiryDate.getMonth() + subscription.periodValue);\n        } else if (subscription.periodUnit === 'year') {\n          newExpiryDate.setFullYear(newExpiryDate.getFullYear() + subscription.periodValue);\n        }\n      }\n\n      console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u66F4\u65B0\u5230\u671F\u65E5\u671F: ' + newExpiryDate.toISOString());\n\n      const updatedSubscription = { ...subscription, expiryDate: newExpiryDate.toISOString() };\n      updatedSubscriptions.push(updatedSubscription);\n      hasUpdates = true;\n\n      const newDaysDiff = Math.ceil((newExpiryDate - now) / (1000 * 60 * 60 * 24));\n      let reminderDays = subscription.reminderDays !== undefined ? subscription.reminderDays : 7;\n      let shouldRemindAfterRenewal = false;\n      if (reminderDays === 0) {\n        shouldRemindAfterRenewal = newDaysDiff === 0;\n      } else {\n        shouldRemindAfterRenewal = newDaysDiff >= 0 && newDaysDiff <= reminderDays;\n      }\n      if (shouldRemindAfterRenewal) {\n        console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5728\u63D0\u9192\u8303\u56F4\u5185\uFF0C\u5C06\u53D1\u9001\u901A\u77E5');\n        expiringSubscriptions.push({\n          ...updatedSubscription,\n          daysRemaining: newDaysDiff\n        });\n      }\n      continue;\n    }\n  }\n\n  const reminderDays = subscription.reminderDays !== undefined ? subscription.reminderDays : 7;\n  let shouldRemind = false;\n  if (reminderDays === 0) {\n    shouldRemind = daysDiff === 0;\n  } else {\n    shouldRemind = daysDiff >= 0 && daysDiff <= reminderDays;\n  }\n\n  if (daysDiff < 0 && subscription.autoRenew === false) {\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5DF2\u8FC7\u671F\u4E14\u672A\u542F\u7528\u81EA\u52A8\u7EED\u8BA2\uFF0C\u5C06\u53D1\u9001\u8FC7\u671F\u901A\u77E5');\n    expiringSubscriptions.push({\n      ...subscription,\n      daysRemaining: daysDiff\n    });\n  } else if (shouldRemind) {\n    console.log('[\u5B9A\u65F6\u4EFB\u52A1] \u8BA2\u9605 \"' + subscription.name + '\" \u5728\u63D0\u9192\u8303\u56F4\u5185\uFF0C\u5C06\u53D1\u9001\u901A\u77E5');\n    expiringSubscriptions.push({\n      ...subscription,\n      daysRemaining: daysDiff\n    });\n  }\n}\n\n    if (hasUpdates) {\n      const mergedSubscriptions = subscriptions.map(sub => {\n        const updated = updatedSubscriptions.find(u => u.id === sub.id);\n        return updated || sub;\n      });\n      await env.SUBSCRIPTIONS_KV.put('subscriptions', JSON.stringify(mergedSubscriptions));\n    }\n\n    if (expiringSubscriptions.length > 0) {\n      let commonContent = '';\n      expiringSubscriptions.sort((a, b) => a.daysRemaining - b.daysRemaining);\n\n      const showLunar = config.SHOW_LUNAR === true;\n\n      for (const sub of expiringSubscriptions) {\n        const typeText = sub.customType || '\u5176\u4ED6';\n        const periodText = (sub.periodValue && sub.periodUnit) ? `(\u5468\u671F: ${sub.periodValue} ${ { day: '\u5929', month: '\u6708', year: '\u5E74' }[sub.periodUnit] || sub.periodUnit})` : '';\n\n        let lunarExpiryText = '';\n        if (showLunar) {\n          const expiryDateObj = new Date(sub.expiryDate);\n          const lunarExpiry = lunarCalendar.solar2lunar(expiryDateObj.getFullYear(), expiryDateObj.getMonth() + 1, expiryDateObj.getDate());\n          lunarExpiryText = lunarExpiry ? ` (\u519C\u5386: ${lunarExpiry.fullStr})` : '';\n        }\n\n        let statusText;\n        if (sub.daysRemaining === 0) statusText = `\u26A0\uFE0F **${sub.name}** (${typeText}) ${periodText} \u4ECA\u5929\u5230\u671F\uFF01${lunarExpiryText}`;\n        else if (sub.daysRemaining < 0) statusText = `\uD83D\uDEA8 **${sub.name}** (${typeText}) ${periodText} \u5DF2\u8FC7\u671F ${Math.abs(sub.daysRemaining)} \u5929${lunarExpiryText}`;\n        else statusText = `\uD83D\uDCC5 **${sub.name}** (${typeText}) ${periodText} \u5C06\u5728 ${sub.daysRemaining} \u5929\u540E\u5230\u671F${lunarExpiryText}`;\n\n        if (sub.notes) statusText += `\\n   \u5907\u6CE8: ${sub.notes}`;\n        commonContent += statusText + '\\n\\n';\n      }\n\n      const title = '\u8BA2\u9605\u5230\u671F\u63D0\u9192';\n      await sendNotificationToAllChannels(title, commonContent, config, '[\u5B9A\u65F6\u4EFB\u52A1]');\n    }\n  } catch (error) {\n    console.error('[\u5B9A\u65F6\u4EFB\u52A1] \u68C0\u67E5\u5373\u5C06\u5230\u671F\u7684\u8BA2\u9605\u5931\u8D25:', error);\n  }\n}\n\nfunction getCookieValue(cookieString, key) {\n  if (!cookieString) return null;\n\n  const match = cookieString.match(new RegExp('(^| )' + key + '=([^;]+)'));\n  return match ? match[2] : null;\n}\n\nasync function handleRequest(request, env, ctx) {\n  return new Response(loginPage, {\n    headers: { 'Content-Type': 'text/html; charset=utf-8' }\n  });\n}\n\nconst CryptoJS = {\n  HmacSHA256: function(message, key) {\n    const keyData = new TextEncoder().encode(key);\n    const messageData = new TextEncoder().encode(message);\n\n    return Promise.resolve().then(() => {\n      return crypto.subtle.importKey(\n        \"raw\",\n        keyData,\n        { name: \"HMAC\", hash: {name: \"SHA-256\"} },\n        false,\n        [\"sign\"]\n      );\n    }).then(cryptoKey => {\n      return crypto.subtle.sign(\n        \"HMAC\",\n        cryptoKey,\n        messageData\n      );\n    }).then(buffer => {\n      const hashArray = Array.from(new Uint8Array(buffer));\n      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n    });\n  }\n};\n\nexport default {\n  async fetch(request, env, ctx) {\n    const url = new URL(request.url);\n\n    // \u6DFB\u52A0\u8C03\u8BD5\u9875\u9762\n    if (url.pathname === '/debug') {\n      try {\n        const config = await getConfig(env);\n        const debugInfo = {\n          timestamp: new Date().toISOString(),\n          pathname: url.pathname,\n          kvBinding: !!env.SUBSCRIPTIONS_KV,\n          configExists: !!config,\n          adminUsername: config.ADMIN_USERNAME,\n          hasJwtSecret: !!config.JWT_SECRET,\n          jwtSecretLength: config.JWT_SECRET ? config.JWT_SECRET.length : 0\n        };\n\n        return new Response(`\n<!DOCTYPE html>\n<html>\n<head>\n  <title>\u8C03\u8BD5\u4FE1\u606F</title>\n  <style>\n    body { font-family: monospace; padding: 20px; background: #f5f5f5; }\n    .info { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; }\n    .success { color: green; }\n    .error { color: red; }\n  </style>\n</head>\n<body>\n  <h1>\u7CFB\u7EDF\u8C03\u8BD5\u4FE1\u606F</h1>\n  <div class=\"info\">\n    <h3>\u57FA\u672C\u4FE1\u606F</h3>\n    <p>\u65F6\u95F4: ${debugInfo.timestamp}</p>\n    <p>\u8DEF\u5F84: ${debugInfo.pathname}</p>\n    <p class=\"${debugInfo.kvBinding ? 'success' : 'error'}\">KV\u7ED1\u5B9A: ${debugInfo.kvBinding ? '\u2713' : '\u2717'}</p>\n  </div>\n\n  <div class=\"info\">\n    <h3>\u914D\u7F6E\u4FE1\u606F</h3>\n    <p class=\"${debugInfo.configExists ? 'success' : 'error'}\">\u914D\u7F6E\u5B58\u5728: ${debugInfo.configExists ? '\u2713' : '\u2717'}</p>\n    <p>\u7BA1\u7406\u5458\u7528\u6237\u540D: ${debugInfo.adminUsername}</p>\n    <p class=\"${debugInfo.hasJwtSecret ? 'success' : 'error'}\">JWT\u5BC6\u94A5: ${debugInfo.hasJwtSecret ? '\u2713' : '\u2717'} (\u957F\u5EA6: ${debugInfo.jwtSecretLength})</p>\n  </div>\n\n  <div class=\"info\">\n    <h3>\u89E3\u51B3\u65B9\u6848</h3>\n    <p>1. \u786E\u4FDDKV\u547D\u540D\u7A7A\u95F4\u5DF2\u6B63\u786E\u7ED1\u5B9A\u4E3A SUBSCRIPTIONS_KV</p>\n    <p>2. \u5C1D\u8BD5\u8BBF\u95EE <a href=\"/\">/</a> \u8FDB\u884C\u767B\u5F55</p>\n    <p>3. \u5982\u679C\u4ECD\u6709\u95EE\u9898\uFF0C\u8BF7\u68C0\u67E5Cloudflare Workers\u65E5\u5FD7</p>\n  </div>\n</body>\n</html>`, {\n          headers: { 'Content-Type': 'text/html; charset=utf-8' }\n        });\n      } catch (error) {\n        return new Response(`\u8C03\u8BD5\u9875\u9762\u9519\u8BEF: ${error.message}`, {\n          status: 500,\n          headers: { 'Content-Type': 'text/plain; charset=utf-8' }\n        });\n      }\n    }\n\n    if (url.pathname.startsWith('/api')) {\n      return api.handleRequest(request, env, ctx);\n    } else if (url.pathname.startsWith('/admin')) {\n      return admin.handleRequest(request, env, ctx);\n    } else {\n      return handleRequest(request, env, ctx);\n    }\n  },\n\n  async scheduled(event, env, ctx) {\n    const now = new Date();\n    const beijingTime = new Date(now.getTime() + 8 * 60 * 60 * 1000);\n    console.log('[Workers] \u5B9A\u65F6\u4EFB\u52A1\u89E6\u53D1 UTC:', now.toISOString(), '\u5317\u4EAC\u65F6\u95F4:', beijingTime.toLocaleString('zh-CN', {timeZone: 'Asia/Shanghai'}));\n    await checkExpiringSubscriptions(env);\n  }\n};\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/home/runner/work/SubsTracker/SubsTracker/index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/home/runner/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/home/runner/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/home/runner/work/SubsTracker/SubsTracker/index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/home/runner/work/SubsTracker/SubsTracker/.wrangler/tmp/bundle-a1OIIg/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/home/runner/.npm/_npx/32026684e21afda6/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/home/runner/work/SubsTracker/SubsTracker/.wrangler/tmp/bundle-a1OIIg/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/home/runner/work/SubsTracker/SubsTracker/.wrangler/tmp/bundle-a1OIIg/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": ";;;;AAAA,IAAM,OAAO,oBAAI,IAAI;AAErB,SAAS,SAAS,SAAS,MAAM;AAChC,QAAM,MACL,mBAAmB,MAChB,UACA,IAAI;AAAA,KACH,OAAO,YAAY,WACjB,IAAI,QAAQ,SAAS,IAAI,IACzB,SACD;AAAA,EACH;AACH,MAAI,IAAI,QAAQ,IAAI,SAAS,SAAS,IAAI,aAAa,UAAU;AAChE,QAAI,CAAC,KAAK,IAAI,IAAI,SAAS,CAAC,GAAG;AAC9B,WAAK,IAAI,IAAI,SAAS,CAAC;AACvB,cAAQ;AAAA,QACP;AAAA,KACO,IAAI,SAAS,CAAC;AAAA;AAAA,MACtB;AAAA,IACD;AAAA,EACD;AACD;AAnBS;AAqBT,WAAW,QAAQ,IAAI,MAAM,WAAW,OAAO;AAAA,EAC9C,MAAM,QAAQ,SAAS,UAAU;AAChC,UAAM,CAAC,SAAS,IAAI,IAAI;AACxB,aAAS,SAAS,IAAI;AACtB,WAAO,QAAQ,MAAM,QAAQ,SAAS,QAAQ;AAAA,EAC/C;AACD,CAAC;;;AC1BD,SAAS,kBAAkB,OAAO,oBAAI,KAAK,GAAG,SAAS,QAAQ;AAC7D,MAAI,WAAW,QAAQ;AACrB,WAAO,KAAK,mBAAmB,SAAS;AAAA,MACtC,UAAU;AAAA,MACV,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,IACP,CAAC;AAAA,EACH,WAAW,WAAW,YAAY;AAChC,WAAO,KAAK,eAAe,SAAS;AAAA,MAClC,UAAU;AAAA,MACV,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,IACV,CAAC;AAAA,EACH,OAAO;AAEL,WAAO,KAAK,eAAe,SAAS;AAAA,MAClC,UAAU;AAAA,IACZ,CAAC;AAAA,EACH;AACF;AAxBS;AA2BT,IAAM,gBAAgB;AAAA;AAAA,EAEpB,WAAW;AAAA,IACT;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IACjF;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;AAAA,IAAS;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AA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAstDlB,IAAM,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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",
  "names": ["token", "config", "reminderDays", "newExpiryDate"]
}
